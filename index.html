<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.svg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.svg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"muleandhorse.icu","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="如果站长加班加似了，这个网站就是他留给世界最后的遗产">
<meta property="og:type" content="website">
<meta property="og:title" content="Mule and Horse">
<meta property="og:url" content="http://muleandhorse.icu/index.html">
<meta property="og:site_name" content="Mule and Horse">
<meta property="og:description" content="如果站长加班加似了，这个网站就是他留给世界最后的遗产">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="RickyD">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://muleandhorse.icu/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Mule and Horse</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Mule and Horse</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">一个工地仔的救赎之路</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">67</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">2</span></a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">10</span></a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://muleandhorse.icu/2023/03/24/b03%20%E4%BD%BF%E7%94%A8next%E4%B8%BB%E9%A2%98%E8%B0%83%E6%95%B4blog%E7%9A%84%E6%A0%B7%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="RickyD">
      <meta itemprop="description" content="如果站长加班加似了，这个网站就是他留给世界最后的遗产">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mule and Horse">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/24/b03%20%E4%BD%BF%E7%94%A8next%E4%B8%BB%E9%A2%98%E8%B0%83%E6%95%B4blog%E7%9A%84%E6%A0%B7%E5%BC%8F/" class="post-title-link" itemprop="url">使用next主题调整blog的样式【持续更新】</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-24 20:09:52" itemprop="dateCreated datePublished" datetime="2023-03-24T20:09:52+08:00">2023-03-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-04-01 11:38:04" itemprop="dateModified" datetime="2023-04-01T11:38:04+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>9 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>next主题虽然配置简单，但是界面太素了，其实本身自带的配置文件就可以实现一些不错的功能，以下是我从网络上整理<del>copy</del>的一些设置技巧。工具需要:git bash或者cmd，都需要使用管理员权限打开。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/03/24/b03%20%E4%BD%BF%E7%94%A8next%E4%B8%BB%E9%A2%98%E8%B0%83%E6%95%B4blog%E7%9A%84%E6%A0%B7%E5%BC%8F/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://muleandhorse.icu/2023/07/10/b47%20vue-router/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="RickyD">
      <meta itemprop="description" content="如果站长加班加似了，这个网站就是他留给世界最后的遗产">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mule and Horse">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/07/10/b47%20vue-router/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-07-10 09:53:39" itemprop="dateCreated datePublished" datetime="2023-07-10T09:53:39+08:00">2023-07-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-07-07 17:39:22" itemprop="dateModified" datetime="2023-07-07T17:39:22+08:00">2023-07-07</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>7 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Vue-Router"><a href="#Vue-Router" class="headerlink" title="Vue-Router"></a>Vue-Router</h2><h3 id="1-认识路由"><a href="#1-认识路由" class="headerlink" title="1.认识路由"></a>1.认识路由</h3><h4 id="1-1-路由"><a href="#1-1-路由" class="headerlink" title="1.1 路由"></a>1.1 路由</h4><ul>
<li>路由其实网络工程的一个词语，在架构一个网络的时候重要的两个东西就是路由器和交换机，路由器最主要的工作维护一个映射表，映射表决定数据的流向。</li>
<li>所谓的路由就是一个映射表</li>
<li>前端路由就是一个组件，后端路由就是一个函数</li>
</ul>
<h4 id="1-2-web-的路由发展"><a href="#1-2-web-的路由发展" class="headerlink" title="1.2 web 的路由发展"></a>1.2 web 的路由发展</h4><ul>
<li>后端路由</li>
</ul>
<p><img src="https://img-1317399399.cos.ap-guangzhou.myqcloud.com//imgimage-20230707171829184.png" alt="image-20230707171829184"></p>
<ul>
<li>前后端分离<ul>
<li>前端负责渲染&#x2F;展示，后端负责提供接口。</li>
<li>前端重交互，后端重逻辑</li>
</ul>
</li>
<li>单页富应用（spa）</li>
<li>只是在前后端分离的基础上加了一层前端路由，交给前端开发来维护映射表。核心：改变 url，页面不会整体重新加载。</li>
</ul>
<p><img src="https://img-1317399399.cos.ap-guangzhou.myqcloud.com//imgimage-20230707171810469.png" alt="image-20230707171810469"></p>
<h4 id="1-3-URL-的-hash-和-HTML5-的-history"><a href="#1-3-URL-的-hash-和-HTML5-的-history" class="headerlink" title="1.3 URL 的 hash 和 HTML5 的 history"></a>1.3 URL 的 hash 和 HTML5 的 history</h4><h5 id="1-3-1-hash"><a href="#1-3-1-hash" class="headerlink" title="1.3.1 hash"></a>1.3.1 hash</h5><ul>
<li>url 的 hash 就是锚点(井号#)，本质上改变 window 的 location.href 的属性。</li>
</ul>
<p>hash 的原理</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#/home&quot;</span>&gt;</span>home<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#/about&quot;</span>&gt;</span>about<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;router-view&quot;</span>&gt;</span>路由展示区域<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> routerViewEl = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.router-view&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//监听你页面的hash的变化--hashchange</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;hashchange&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">switch</span> (location.<span class="property">hash</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">case</span> <span class="string">&#x27;#/home&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">        routerViewEl.<span class="property">innerHTML</span> = <span class="string">&#x27;home&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">case</span> <span class="string">&#x27;#/about&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">        routerViewEl.<span class="property">innerHTML</span> = <span class="string">&#x27;about&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">default</span>:</span></span><br><span class="line"><span class="language-javascript">        routerViewEl.<span class="property">innerHTML</span> = <span class="string">&#x27;default&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>好处：兼容性强，ie 都可以用</li>
<li>缺点：有点丑多了一个#，显得不太像一个真实的路径</li>
</ul>
<h5 id="1-3-2-history"><a href="#1-3-2-history" class="headerlink" title="1.3.2 history"></a>1.3.2 history</h5><ul>
<li>是 html5 新增的，go，forward，back，reaplceState 替换原有路径，pushState 压入新的路径，popState 回退</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/home&quot;</span>&gt;</span>home<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>about<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;router-view&quot;</span>&gt;</span>路由展示区域<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> routerViewEl = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.router-view&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//获取所有的a标签</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> aEls = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;a&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">for</span> (<span class="keyword">const</span> aEl <span class="keyword">of</span> aEls) &#123;</span></span><br><span class="line"><span class="language-javascript">    aEl.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      e.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> href = aEl.<span class="title function_">getAttribute</span>(<span class="string">&#x27;href&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">      history.<span class="title function_">pushState</span>(&#123;&#125;, <span class="string">&#x27;&#x27;</span>, href);</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">historyChange</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">historyChange</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//映射表在这里维护 路径的名称</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">switch</span> (location.<span class="property">pathname</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">case</span> <span class="string">&#x27;/home&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">        routerViewEl.<span class="property">innerHTML</span> = <span class="string">&#x27;home&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">case</span> <span class="string">&#x27;/about&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">        routerViewEl.<span class="property">innerHTML</span> = <span class="string">&#x27;about&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">default</span>:</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-Vue-Router-基本使用"><a href="#2-Vue-Router-基本使用" class="headerlink" title="2.Vue-Router 基本使用"></a>2.Vue-Router 基本使用</h3><h4 id="2-1-认识"><a href="#2-1-认识" class="headerlink" title="2.1 认识"></a>2.1 认识</h4><ul>
<li>三大框架，都有自己的路由的实现</li>
<li>Angular-ngRouter</li>
<li>React-ReactRouter</li>
<li>Vue VueRouter 能够与我们的 vue 深度集成，让 Vue 构建 SPA 变得非常的容易</li>
<li>vue-router 基于路由和组件的<ul>
<li>路由用户设定访问的路径，router 将路径和组件映射起来</li>
</ul>
</li>
</ul>
<h4 id="2-2-使用步骤"><a href="#2-2-使用步骤" class="headerlink" title="2.2 使用步骤"></a>2.2 使用步骤</h4><ul>
<li>安装：npm install vue-router</li>
<li>使用:<ul>
<li>第一步:创建需要映射的组件(页面组件&#x2F;路由组件)</li>
<li>第二步:通过 createRouter 创建路由对象(router)，并且传入 routes 和 history 模式<ul>
<li>routes 映射表，配置 path 和组件的映射关系</li>
<li>istory 用于指定路由的模式是 hash 还是 history</li>
</ul>
</li>
<li>第三步：使用 app 注册路由对象（use 方法</li>
<li>第四步：使用路由，通过<router-link>跳转 <router-view>展示</li>
</ul>
</li>
</ul>
<h4 id="2-3-默认路径"><a href="#2-3-默认路径" class="headerlink" title="2.3 默认路径"></a>2.3 默认路径</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">//默认根路径 /匹配到首页</span></span><br><span class="line">  <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">  <span class="comment">// 重定向 将根路径 / 匹配到/home</span></span><br><span class="line">  <span class="attr">redirect</span>: <span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h4 id="2-4-router-link-的属性"><a href="#2-4-router-link-的属性" class="headerlink" title="2.4 router-link 的属性"></a>2.4 router-link 的属性</h4><ul>
<li>to:可以是字符串，也可以是对象，实际开发一般字符串</li>
<li>replace：相当于调用 router.replace 而不是 router.push，所以会没有历史记录</li>
<li>router-link-active:默认激活的路由的类名，可以写一些样式</li>
<li>active-class&#x3D;”类名”：不想用默认的那么长的类名的时候，自己指定激活的类名</li>
</ul>
<h3 id="3-路由懒加载"><a href="#3-路由懒加载" class="headerlink" title="3.路由懒加载"></a>3.路由懒加载</h3><ul>
<li>因为 component 可以传入一个组件，也可以接受一个函数，该函数需要返回一个 promise 才可以；import()函数返回一个 promise</li>
</ul>
<h3 id="4-路由的其他属性"><a href="#4-路由的其他属性" class="headerlink" title="4.路由的其他属性"></a>4.路由的其他属性</h3><ul>
<li>name 属性<ul>
<li>记录路由的独一无二的名字，在后面的编程式路由导航中用到</li>
</ul>
</li>
<li>meta 属性<ul>
<li>自定义数据，结合业务需要使用，鉴权：meta+导航守卫</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">     <span class="attr">name</span>: <span class="string">&#x27;home&#x27;</span>,</span><br><span class="line">     <span class="comment">//path就是路径，component就是你要展示的路由组件</span></span><br><span class="line">     <span class="attr">path</span>: <span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">     <span class="attr">meta</span>: &#123;</span><br><span class="line">       <span class="attr">name</span>: <span class="string">&#x27;alex&#x27;</span>,</span><br><span class="line">       <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="comment">//实际开发的路由懒加载的写法</span></span><br><span class="line">     <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Home.vue&#x27;</span>),</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="5-动态路由和嵌套路由"><a href="#5-动态路由和嵌套路由" class="headerlink" title="5.动态路由和嵌套路由"></a>5.动态路由和嵌套路由</h3><h4 id="5-1-动态路由"><a href="#5-1-动态路由" class="headerlink" title="5.1 动态路由"></a>5.1 动态路由</h4><ul>
<li>路径参数的传递和使用</li>
<li>传递</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">     <span class="attr">name</span>: <span class="string">&#x27;user&#x27;</span>,</span><br><span class="line">     <span class="comment">//路径参数  xxx.id</span></span><br><span class="line">     <span class="attr">path</span>: <span class="string">&#x27;/user/:id&#x27;</span>,</span><br><span class="line">     <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/User.vue&#x27;</span>),</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<ul>
<li>获取</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;用户页面&lt;/h2&gt;</span><br><span class="line">    &lt;!-- 模版中使用 --&gt;</span><br><span class="line">    &lt;h2&gt;用户的id:&#123;&#123; $route.params.id &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;p&gt;根据用的id去请求对应的用户的信息，这个时候路由跳转的时候就得携带参数&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">//如果你在optionsAPI里面想要获取</span><br><span class="line">//this.$route.params.xxx</span><br><span class="line">//setup中使用，我们需要利用官方提供的hook</span><br><span class="line">import &#123; useRoute, onBeforeRouteUpdate &#125; from &#x27;vue-router&#x27;;</span><br><span class="line">const route = useRoute();</span><br><span class="line">// console.log(route.params.id);</span><br><span class="line"></span><br><span class="line">//了解  生命周期==钩子</span><br><span class="line">onBeforeRouteUpdate((to, from) =&gt; &#123;</span><br><span class="line">  console.log(&#x27;from&#x27;, from.params.id);</span><br><span class="line">  console.log(&#x27;to&#x27;, to.params.id);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="5-2-NotFound"><a href="#5-2-NotFound" class="headerlink" title="5.2 NotFound"></a>5.2 NotFound</h4><ul>
<li>对于没有匹配到的路由，我们往往会匹配到一个固定的页面</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// abc aaa zzzz</span></span><br><span class="line">  <span class="comment">//*有区别， 区别在于是否解析/</span></span><br><span class="line">  <span class="attr">path</span>: <span class="string">&#x27;/:pathMatch(.*)*&#x27;</span>,</span><br><span class="line">  <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/NotFound.vue&#x27;</span>),</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>NotFound.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;</span><br><span class="line">      您访问的路径</span><br><span class="line">      &lt;span&gt;&#123;&#123; $route.params.pathMatch &#125;&#125;&lt;/span&gt;</span><br><span class="line">      有错误</span><br><span class="line">    &lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">span &#123;</span><br><span class="line">  font-size: 50px;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="5-3-嵌套路由"><a href="#5-3-嵌套路由" class="headerlink" title="5.3 嵌套路由"></a>5.3 嵌套路由</h4><ul>
<li>上面写过的 Home，About，User 都属于第一层的路由，实际上路由情况往往更复杂，某些页面会有对应的子页面，这个时候我们就需要使用嵌套路由</li>
<li>在 children 中配置，具体规则写法和 routes 的数组一致，注意子路由填写 path 时不要加&#x2F;即可</li>
</ul>
<h3 id="6-编程式路由导航"><a href="#6-编程式路由导航" class="headerlink" title="6.编程式路由导航"></a>6.编程式路由导航</h3><ul>
<li>用 js 来控制路由跳转</li>
</ul>
<h4 id="6-1-代码控制页面跳转"><a href="#6-1-代码控制页面跳转" class="headerlink" title="6.1 代码控制页面跳转"></a>6.1 代码控制页面跳转</h4><ul>
<li>在 option 中使用 this.$router.push</li>
<li>在 setup 我们要先调用 vue-router 提供的 useRouter 的 hook，获取到路由器的实例然后操作</li>
</ul>
<h4 id="6-2-路由传参"><a href="#6-2-路由传参" class="headerlink" title="6.2 路由传参"></a>6.2 路由传参</h4><ol>
<li>动态路由的&#x2F;:id</li>
<li>query 方式</li>
</ol>
<ul>
<li>在 push 或者其他跳转页面的操作中添加你要的参数</li>
</ul>
<h4 id="6-3-其他操作路由的方法"><a href="#6-3-其他操作路由的方法" class="headerlink" title="6.3 其他操作路由的方法"></a>6.3 其他操作路由的方法</h4><ul>
<li>replace：模版中配置，router-link 上添加一个 replace 属性即可；编程式路由导航：router.replace({})传递参数写法和 push 一样</li>
<li>go：<ul>
<li>router.go(1) 前进一个页面</li>
<li>router.go(-1)后退一个页面</li>
<li>history.back()相当于 go（-1）</li>
<li>history.forward()相当于 go(1)</li>
</ul>
</li>
</ul>
<h3 id="7-动态管理路由"><a href="#7-动态管理路由" class="headerlink" title="7.动态管理路由"></a>7.动态管理路由</h3><h4 id="7-1-动态添加路由"><a href="#7-1-动态添加路由" class="headerlink" title="7.1 动态添加路由"></a>7.1 动态添加路由</h4><p><img src="https://img-1317399399.cos.ap-guangzhou.myqcloud.com//imgimage-20230707171735718.png" alt="image-20230707171735718"></p>
<ul>
<li>addRoute 函数来动态添加路由</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> isAdmin = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (isAdmin) &#123;</span><br><span class="line">  <span class="comment">//添加对应的路由进去</span></span><br><span class="line">  <span class="comment">//一级路由</span></span><br><span class="line">  router.<span class="title function_">addRoute</span>(&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/admin&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Admin.vue&#x27;</span>),</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//添加homevip作为home的子路由</span></span><br><span class="line">  router.<span class="title function_">addRoute</span>(<span class="string">&#x27;home&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;vip&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/HomeVip.vue&#x27;</span>),</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-路由导航守卫"><a href="#8-路由导航守卫" class="headerlink" title="8.路由导航守卫"></a>8.路由导航守卫</h3><h4 id="8-1-基本使用"><a href="#8-1-基本使用" class="headerlink" title="8.1 基本使用"></a>8.1 基本使用</h4><ul>
<li><p>vue-router 提供的导航守卫主要用来通过跳转或取消的方式守卫路由</p>
</li>
<li><p>全局前置守卫 beforeEach 是在进入对应的页面之前触发</p>
</li>
<li><p>它有两个参数:</p>
<ul>
<li>to 即将进入的路由</li>
<li>from 即将离开的那个路由</li>
</ul>
</li>
<li><p>它有返回值:</p>
<ul>
<li>false：取消导航</li>
<li>返回对应的路由地址常见的是返回到登录页 “&#x2F;login” {path:”&#x2F;login”}</li>
<li>第三个参数:next(不推荐使用)<ul>
<li>意义不明确，而且会调用多次</li>
</ul>
</li>
</ul>
</li>
<li><p>登录的案例:有一个订单页面 Order，有一个 Login 登录页面</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//路由守卫</span></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//配合meta使用</span></span><br><span class="line">  <span class="keyword">const</span> token = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;token&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (to.<span class="property">meta</span>.<span class="property">requireAuth</span> &amp;&amp; !token) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;/login&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// //不管你去到那个页面你都得跳到登录</span></span><br><span class="line">  <span class="comment">// //useRoute  route</span></span><br><span class="line">  <span class="comment">// // console.log(to);</span></span><br><span class="line">  <span class="comment">// //如果访问的页面不是登录页</span></span><br><span class="line">  <span class="comment">// if (to.path !== &#x27;/login&#x27;) &#123;</span></span><br><span class="line">  <span class="comment">//   //都跳到登录页</span></span><br><span class="line">  <span class="comment">//   return &#x27;/login&#x27;;</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// //进入到某些页面才去登录页 order</span></span><br><span class="line">  <span class="comment">// const token = localStorage.getItem(&#x27;token&#x27;);</span></span><br><span class="line">  <span class="comment">// if (to.path === &#x27;/order&#x27; &amp;&amp; !token) &#123;</span></span><br><span class="line">  <span class="comment">//   return &#x27;/login&#x27;;</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>其他的守卫：</li>
<li>全局：<ul>
<li>router.beforeEach 全局前置守卫</li>
<li>router.beforeResolve 全局解析守卫</li>
<li>router.afterEach 全局后置守卫</li>
</ul>
</li>
<li>组件内的：<ul>
<li>beforeRouterEnter 进入前</li>
<li>beforeRouteUpdate 更新前</li>
<li>beforeRouteLeave 离开前</li>
</ul>
</li>
<li>路由的独享守卫<ul>
<li>直接在映射表里书写</li>
<li>beforeEnter</li>
</ul>
</li>
</ul>
<h4 id="8-2-路由的解析流程"><a href="#8-2-路由的解析流程" class="headerlink" title="8.2 路由的解析流程"></a>8.2 路由的解析流程</h4><ul>
<li>home-&gt;about</li>
</ul>
<ol>
<li>beforeRouteLeave 离开 home 之前</li>
<li>调用 beforeEach</li>
<li>进入到对应的路由</li>
<li>如果有重用的组件就会调用 beforeRouteUpdate user&#x2F;123-&gt;user&#x2F;321</li>
<li>在映射表里面调用对应 beforeEnter</li>
<li>解析异步的路由组件()&#x3D;&gt;import(‘about 的路径’)</li>
<li>beforeRouteEnter 进入 about 之前</li>
<li>调用全局的 beforeResolve 在跳转之前</li>
<li>进行导航跳转</li>
<li>afterEach</li>
<li>触发 dom 更新</li>
<li>调用 next 的回调</li>
</ol>
<h4 id="8-3-前端产品分类"><a href="#8-3-前端产品分类" class="headerlink" title="8.3 前端产品分类"></a>8.3 前端产品分类</h4><p><img src="https://img-1317399399.cos.ap-guangzhou.myqcloud.com//imgimage-20230707171711300.png" alt="image-20230707171711300"></p>
<h4 id="8-4-vite"><a href="#8-4-vite" class="headerlink" title="8.4 vite"></a>8.4 vite</h4><ul>
<li>目前我们配置了 vuex&#x2F;pinia axios vue-router，真实开发</li>
<li>自己配一个有 pinia+vue-router 的预设</li>
<li>创建项目的时候选择你需要的库，他会自动帮我们配置好</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://muleandhorse.icu/2022/07/10/b46%20Pinia%E3%80%81Axios/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="RickyD">
      <meta itemprop="description" content="如果站长加班加似了，这个网站就是他留给世界最后的遗产">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mule and Horse">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/10/b46%20Pinia%E3%80%81Axios/" class="post-title-link" itemprop="url">pinia及axios插件</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-07-10 16:06:09" itemprop="dateCreated datePublished" datetime="2022-07-10T16:06:09+08:00">2022-07-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-07-22 21:12:49" itemprop="dateModified" datetime="2023-07-22T21:12:49+08:00">2023-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.4k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Pinia、Axios"><a href="#Pinia、Axios" class="headerlink" title="Pinia、Axios"></a>Pinia、Axios</h2><h3 id="Pinia"><a href="#Pinia" class="headerlink" title="Pinia"></a>Pinia</h3><h3 id="1-pinia-和-vuex-的对比"><a href="#1-pinia-和-vuex-的对比" class="headerlink" title="1.pinia 和 vuex 的对比"></a>1.pinia 和 vuex 的对比</h3><h4 id="1-1-pinia"><a href="#1-1-pinia" class="headerlink" title="1.1 pinia"></a>1.1 pinia</h4><ul>
<li>pinia 是一个状态管理的库，用于跨组件&#x2F;跨页面共享状态</li>
<li>pinia 能够同时兼容 vue2，vue3；不强制要求使用组合式 API</li>
<li>vue2-&gt;vuex</li>
<li>vue3-&gt;pinia</li>
</ul>
<h4 id="1-2-pinia-和-vuex-的区别"><a href="#1-2-pinia-和-vuex-的区别" class="headerlink" title="1.2 pinia 和 vuex 的区别"></a>1.2 pinia 和 vuex 的区别</h4><ul>
<li>pinia 最初是为了探索下一次 vuex 会是什么样，结合了 vuex5 核心团队讨论的</li>
<li>pinia 取代了 vuex</li>
<li>有更少的仪式感，提供了风格统一的组合式 API<ol>
<li>mutation 不再存在，原先存在是因为 devtools</li>
<li>modules 不再嵌套 ✅</li>
<li>不再有命名空间</li>
<li>更好的 ts 的支持</li>
</ol>
</li>
</ul>
<h3 id="2-pinia-使用"><a href="#2-pinia-使用" class="headerlink" title="2.pinia 使用"></a>2.pinia 使用</h3><h4 id="2-1-安装"><a href="#2-1-安装" class="headerlink" title="2.1 安装"></a>2.1 安装</h4><ul>
<li>pinia 安装: npm install pinia</li>
</ul>
<h4 id="2-2-配置"><a href="#2-2-配置" class="headerlink" title="2.2 配置"></a>2.2 配置</h4><ul>
<li>vuex 的配置你会的话，pinia 的配置类似</li>
</ul>
<p>.&#x2F;stores&#x2F;index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//引入创建pinia的函数</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"><span class="comment">//创建一个pinia</span></span><br><span class="line"><span class="keyword">const</span> pinia = <span class="title function_">createPinia</span>();</span><br><span class="line"><span class="comment">//暴露出去</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> pinia;</span><br></pre></td></tr></table></figure>

<p>main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span>;</span><br><span class="line"><span class="comment">//引入pinia</span></span><br><span class="line"><span class="keyword">import</span> pinia <span class="keyword">from</span> <span class="string">&#x27;./stores&#x27;</span>;</span><br><span class="line"><span class="comment">//use使用</span></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">use</span>(pinia).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="3-Store"><a href="#3-Store" class="headerlink" title="3.Store"></a>3.Store</h3><h4 id="3-1-store-的定义"><a href="#3-1-store-的定义" class="headerlink" title="3.1 store 的定义"></a>3.1 store 的定义</h4><ul>
<li>store 是一个实体，他会存储组件中需要的状态和逻辑，并且每个组件都能读取&#x2F;写入，在你的应用中根据你的需要定义任意个数的 store 来管理状态</li>
<li>三个核心概念：<ul>
<li>state，getters，actions 类似组件的 data，computed，methods；一旦你的 store 被实例化，就可以直接在 store 访问所有你需要的 state，getters，actions。</li>
</ul>
</li>
</ul>
<h4 id="3-2-定义-store"><a href="#3-2-定义-store" class="headerlink" title="3.2 定义 store"></a>3.2 定义 store</h4><p>.&#x2F;stores&#x2F;counter.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义store</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"><span class="comment">//第一个参数是唯一的名称，又叫id</span></span><br><span class="line"><span class="keyword">const</span> useCounter = <span class="title function_">defineStore</span>(<span class="string">&#x27;counter&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useCounter;</span><br></pre></td></tr></table></figure>

<ul>
<li>store 在被使用之前是不会创建的，你得在组件中通过调用 useXXX 函数来使用 store</li>
</ul>
<h4 id="3-3-使用-store"><a href="#3-3-使用-store" class="headerlink" title="3.3 使用 store"></a>3.3 使用 store</h4><p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;!-- 在模版和setup中风格统一的 --&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; countStore.count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import useCounter from &#x27;./stores/counter&#x27;;</span><br><span class="line">//countStore就是一个store的实例</span><br><span class="line">const countStore = useCounter();</span><br><span class="line">console.log(countStore.count);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>注意：store 获取到以后不要直接解构，会丢失响应式，解决这个问题可以使用 toRefs 但是 pinia 给我们提供了对应的辅助函数 storeToRefs,更推荐使用 storeToRefs，他能明确数据的来源是 store</li>
</ul>
<p>App</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;!-- 在模版和setup中风格统一的 --&gt;</span><br><span class="line">    &lt;h2&gt;没解构&#123;&#123; countStore.count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;解构了&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import useCounter from &#x27;./stores/counter&#x27;;</span><br><span class="line">import &#123; storeToRefs &#125; from &#x27;pinia&#x27;;</span><br><span class="line">//countStore就是一个store的实例</span><br><span class="line">const countStore = useCounter();</span><br><span class="line">const &#123; count &#125; = storeToRefs(countStore);</span><br><span class="line">// const &#123; count &#125; = countStore;</span><br><span class="line">// const count =1</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="4-State"><a href="#4-State" class="headerlink" title="4.State"></a>4.State</h3><ul>
<li>操作 state：</li>
</ul>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; name &#125;&#125;--&#123;&#123; age &#125;&#125;--&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;change&quot;&gt;点我修改&lt;/button&gt;</span><br><span class="line">    &lt;!-- &lt;button @click=&quot;changeName&quot;&gt;修改name&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeAge&quot;&gt;修改age&lt;/button&gt; --&gt;</span><br><span class="line">    &lt;button @click=&quot;reset&quot;&gt;重置&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import useCounter from &#x27;./stores/counter&#x27;;</span><br><span class="line">import &#123; storeToRefs &#125; from &#x27;pinia&#x27;;</span><br><span class="line">const countStore = useCounter();</span><br><span class="line">const &#123; count, name, age &#125; = storeToRefs(countStore);</span><br><span class="line">//直接通过实例修改</span><br><span class="line">const change = () =&gt; &#123;</span><br><span class="line">  //一个个的修改太麻烦</span><br><span class="line">  // countStore.count += 1;</span><br><span class="line">  // countStore.name += &#x27;天河阔少&#x27;;</span><br><span class="line">  // countStore.age += 10;</span><br><span class="line">  //提供了一个api，一次修改多个</span><br><span class="line">  countStore.$patch(&#123;</span><br><span class="line">    count: 99,</span><br><span class="line">    name: &#x27;天河阔少&#x27;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">// const changeName = () =&gt; &#123;</span><br><span class="line">//   countStore.name += &#x27;天河阔少&#x27;;</span><br><span class="line">// &#125;;</span><br><span class="line">// const changeAge = () =&gt; &#123;</span><br><span class="line">//   countStore.age += 10;</span><br><span class="line">// &#125;;</span><br><span class="line">//pinia提供的重置api</span><br><span class="line">const reset = () =&gt; &#123;</span><br><span class="line">  countStore.$reset();</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="5-getters"><a href="#5-getters" class="headerlink" title="5.getters"></a>5.getters</h3><p>user.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> useUser = <span class="title function_">defineStore</span>(<span class="string">&#x27;user&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;alex&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useUser;</span><br></pre></td></tr></table></figure>

<p>counter.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义store</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"><span class="comment">//引入</span></span><br><span class="line"><span class="keyword">import</span> useUser <span class="keyword">from</span> <span class="string">&#x27;./user&#x27;</span>;</span><br><span class="line"><span class="comment">//第一个参数是唯一的名称，又叫id</span></span><br><span class="line"><span class="keyword">const</span> useCounter = <span class="title function_">defineStore</span>(<span class="string">&#x27;counter&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">33</span>,</span><br><span class="line">    <span class="attr">friends</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="number">111</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;沸羊羊&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="number">112</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;双面龟&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="number">113</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;黑小虎&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="comment">//翻倍count</span></span><br><span class="line">    <span class="title function_">doubleCount</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.<span class="property">count</span> * <span class="number">2</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//翻倍并且+1</span></span><br><span class="line">    <span class="comment">//pinia的getters可以很方便的访问到其他getters</span></span><br><span class="line">    <span class="title function_">doubleCountAddOne</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      <span class="comment">// return state.count * 2 + 1;</span></span><br><span class="line">      <span class="comment">//this指向当前的store实例</span></span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">doubleCount</span> + <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//根据id返回friend</span></span><br><span class="line">    <span class="title function_">getFriendById</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="title function_">showMsg</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">//使用其他store中的数据</span></span><br><span class="line">      <span class="keyword">const</span> useStore = <span class="title function_">useUser</span>();</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;useStore.name&#125;</span>--<span class="subst">$&#123;useStore.age&#125;</span>`</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useCounter;</span><br></pre></td></tr></table></figure>

<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; doubleCount &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; doubleCountAddOne &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; showMsg &#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import useCounter from &#x27;./stores/counter&#x27;;</span><br><span class="line">import &#123; storeToRefs &#125; from &#x27;pinia&#x27;;</span><br><span class="line">const countStore = useCounter();</span><br><span class="line">const &#123; doubleCount, doubleCountAddOne, showMsg &#125; = storeToRefs(countStore);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="6-Actions"><a href="#6-Actions" class="headerlink" title="6.Actions"></a>6.Actions</h3><ul>
<li>action 相当于组件中的 methods，他非常适合定义业务逻辑，可以在里面进行各种修改的操作，而且 action 本身可以直接异步</li>
<li>计数器：加 减 延迟加 延迟减</li>
</ul>
<p>counter.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义store</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useCounter = <span class="title function_">defineStore</span>(<span class="string">&#x27;counter&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">33</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="comment">//定义action</span></span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">add</span>(<span class="params">payload</span>) &#123;</span><br><span class="line">      <span class="comment">//和getters一样 actions中的函数的thi  s-&gt;当前的store实例</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span> += payload;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">sub</span>(<span class="params">payload</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span> -= payload;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">addLate</span>(<span class="params">&#123; payload, delay &#125;</span>) &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">count</span> += payload;</span><br><span class="line">      &#125;, delay);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">subLate</span>(<span class="params">&#123; payload, delay &#125;</span>) &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">count</span> -= payload;</span><br><span class="line">      &#125;, delay);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useCounter;</span><br></pre></td></tr></table></figure>

<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;当前计数:&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;piniaAdd(3)&quot;&gt;直接+&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;sub(3)&quot;&gt;直接-&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;addLate(&#123; payload: 5, delay: 1000 &#125;)&quot;&gt;延迟+&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;subLate(&#123; payload: 5, delay: 1000 &#125;)&quot;&gt;延迟-&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;add&quot;&gt;++&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import useCounter from &#x27;./stores/counter&#x27;;</span><br><span class="line">import &#123; storeToRefs &#125; from &#x27;pinia&#x27;;</span><br><span class="line">const countStore = useCounter();</span><br><span class="line">const &#123; count &#125; = storeToRefs(countStore);</span><br><span class="line">//const &#123;add:add&#125; 前面的add是本来对象里面的，后面的add是我们起的名字，只不过往往都一样就简写</span><br><span class="line">const &#123; add: piniaAdd, sub, addLate, subLate &#125; = countStore;</span><br><span class="line">const add = () =&gt; &#123;</span><br><span class="line">  console.log(&#x27;组件本来的方法&#x27;);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Axios"><a href="#Axios" class="headerlink" title="Axios"></a>Axios</h3><ul>
<li>准备工作</li>
<li>axios 官网：<a target="_blank" rel="noopener" href="https://www.axios-http.cn/">https://www.axios-http.cn/</a></li>
<li>新建一个 db.json 文件，填入如下内容</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;users&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;alex&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;123&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jack&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;456&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;张三&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;666&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>打开终端输入如下命令启动一个后端接口服务</li>
</ul>
<p><code>json-server --w db.json</code></p>
<ul>
<li>终端出现如下界面表示成功，此时可以访问浏览器的 localhost:3000 查看数据</li>
</ul>
<p><img src="C:\Users\Q\AppData\Roaming\Typora\typora-user-images\image-20230706173911206.png" alt="image-20230706173911206"></p>
<p>-axios:ajax i&#x2F;o system 避免每个人对 xml 封装不一致，提供了统一的配置选项</p>
<ul>
<li>简单使用：直接在对应的 script 标签中书写</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"><span class="comment">// //1.普通使用</span></span><br><span class="line"><span class="comment">// axios.get(&#x27;http://localhost:3000/users&#x27;).then((res) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   console.log(res);</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"><span class="comment">// //get post  delete patch put</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.async await 使用</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getUsers</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">//await 直接获取promise的结果</span></span><br><span class="line">  <span class="keyword">let</span> res = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;http://localhost:3000/users&#x27;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">getUsers</span>();</span><br></pre></td></tr></table></figure>

<ul>
<li><p>直接这样使用相当于是用的 axios 默认的实例，默认的实例往往不能满足我们的需要，比如配置基础路径，比如配置超时时间设置，比如请求头中 token(用户认证标识)的设置</p>
</li>
<li><p>配置自己的 axios 实例</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"><span class="comment">//实际开发 往往自己创建自己对应的axios实例来使用</span></span><br><span class="line"><span class="keyword">const</span> instance = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="comment">//根路径</span></span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&#x27;http://localhost:3000&#x27;</span>,</span><br><span class="line">  <span class="comment">//超时时间 1s</span></span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">1000</span>,</span><br><span class="line">  <span class="comment">//请求头的配置</span></span><br><span class="line">  <span class="comment">// x-token的请求头，登录以后放到localStorage/sessionStorage</span></span><br><span class="line">  <span class="comment">// headers: &#123; &#x27;token Beare &#x27;: token &#125;,</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//使用实例来请求</span></span><br><span class="line">instance.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>请求和响应的拦截器</li>
<li>请求：在真正发出请求之前我做一些事，比如加上用户认证标识 token 之类的</li>
<li>响应：请求回来了我要做一些处理，</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> instance = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&#x27;http://localhost:3000&#x27;</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">1000</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//请求拦截器的配置(成功的拦截，失败的拦截)</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;请求成功的拦截&#x27;</span>, config);</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;请求失败的拦截&#x27;</span>, err);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">//响应拦截器的配置(成功的拦截，失败的拦截)</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;响应成功的拦截&#x27;</span>, res);</span><br><span class="line">    <span class="comment">//看后端返回的数据解构是怎么样</span></span><br><span class="line">    <span class="keyword">return</span> res.<span class="property">data</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;响应失败的拦截&#x27;</span>, err);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">// //使用实例来请求</span></span><br><span class="line">instance.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>src 下新建一个 services 目录里面新建一个 http.js，填入如下内容</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//封装了axois，专门用来处理请求</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> http = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&#x27;http://localhost:3000&#x27;</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">1000</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//请求拦截器的配置(成功的拦截，失败的拦截)</span></span><br><span class="line">http.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//比如要获取登录后缓存起来的token</span></span><br><span class="line">    <span class="keyword">let</span> token = sessionStorage.<span class="title function_">getItem</span>(<span class="string">&#x27;token&#x27;</span>) || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (!!token) &#123;</span><br><span class="line">      <span class="comment">//[]中的名称，看接口文档/问后端</span></span><br><span class="line">      <span class="comment">//常见的token x-token  Authorition</span></span><br><span class="line">      config.<span class="property">headers</span>[<span class="string">&#x27;x-token&#x27;</span>] = token;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// console.log(&#x27;请求成功的拦截&#x27;, config);</span></span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// console.log(&#x27;请求失败的拦截&#x27;, err);</span></span><br><span class="line">    <span class="comment">// 给予一定的提示</span></span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">//响应拦截器的配置(成功的拦截，失败的拦截)</span></span><br><span class="line">http.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// console.log(&#x27;响应成功的拦截&#x27;, res);</span></span><br><span class="line">    <span class="comment">//看后端返回的数据解构是怎么样</span></span><br><span class="line">    <span class="keyword">return</span> res.<span class="property">data</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// console.log(&#x27;响应失败的拦截&#x27;, err);</span></span><br><span class="line">    <span class="comment">//想要失败被捕获，手动来一个Promise.reject</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(</span><br><span class="line">      (<span class="keyword">function</span> (<span class="params">resp</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">group</span>(</span><br><span class="line">          <span class="string">`%c【代码<span class="subst">$&#123;resp.status&#125;</span>: <span class="subst">$&#123;resp.data.msg&#125;</span>】`</span>,</span><br><span class="line">          <span class="string">&#x27;color:blue;font-size:15px;&#x27;</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">let</span> inputdata = resp.<span class="property">config</span>.<span class="property">data</span></span><br><span class="line">          ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(resp.<span class="property">config</span>.<span class="property">data</span>)</span><br><span class="line">          : <span class="literal">undefined</span>;</span><br><span class="line">        <span class="keyword">let</span> inputparams = resp.<span class="property">config</span>.<span class="property">params</span> ? resp.<span class="property">config</span>.<span class="property">params</span> : <span class="literal">undefined</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">          <span class="string">`%cPREVIEW:\n`</span>,</span><br><span class="line">          <span class="string">&#x27;color:green;font-weight:bold;font-size:18px&#x27;</span>,</span><br><span class="line">          <span class="string">`Data:`</span>,</span><br><span class="line">          inputdata,</span><br><span class="line">          <span class="string">`\n`</span>,</span><br><span class="line">          <span class="string">`Params:`</span>,</span><br><span class="line">          inputparams,</span><br><span class="line">          <span class="string">`\n`</span>,</span><br><span class="line">          &#123; <span class="title class_">Method</span>: resp.<span class="property">config</span>.<span class="property">method</span> &#125;,</span><br><span class="line">          <span class="string">`\n`</span>,</span><br><span class="line">          &#123; <span class="title class_">Url</span>: resp.<span class="property">config</span>.<span class="property">url</span> &#125;,</span><br><span class="line">          <span class="string">`\n`</span>,</span><br><span class="line">          &#123; <span class="title class_">Envir</span>: process.<span class="property">env</span>.<span class="property">NODE_ENV</span> &#125;,</span><br><span class="line">          <span class="string">`\n`</span>,</span><br><span class="line">          &#123; <span class="title class_">Type</span>: resp.<span class="property">config</span>.<span class="property">headers</span>[<span class="string">&#x27;Content-Type&#x27;</span>] &#125;,</span><br><span class="line">          <span class="string">`\n`</span>,</span><br><span class="line">          &#123; <span class="attr">msg</span>: resp.<span class="property">data</span>.<span class="property">msg</span> &#125;,</span><br><span class="line">          <span class="string">`\n`</span>,</span><br><span class="line">          &#123; <span class="attr">status</span>: resp.<span class="property">status</span> &#125;,</span><br><span class="line">          <span class="string">`\n`</span></span><br><span class="line">        );</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">groupEnd</span>();</span><br><span class="line">      &#125;)(error.<span class="property">response</span>)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// //使用实例来请求</span></span><br><span class="line"><span class="comment">// http.get(&#x27;/users&#x27;).then((res) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   console.log(res);</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> http;</span><br></pre></td></tr></table></figure>

<ul>
<li>api 也应该集中起来管理，所以我们在 services 下面新建一个 api.js 管理请求地址</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//配置请求的api</span></span><br><span class="line"><span class="keyword">const</span> baseURL = <span class="string">&#x27;http://localhost:3000&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> api = &#123;</span><br><span class="line">  <span class="comment">//登录</span></span><br><span class="line">  <span class="attr">login</span>: baseURL + <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">  <span class="comment">//获取所有商品</span></span><br><span class="line">  <span class="attr">list</span>: baseURL + <span class="string">&#x27;/list&#x27;</span>,</span><br><span class="line">  <span class="comment">//获取所有用户</span></span><br><span class="line">  <span class="attr">users</span>: baseURL + <span class="string">&#x27;/users&#x27;</span>,</span><br><span class="line">  <span class="comment">// //添加用户</span></span><br><span class="line">  <span class="comment">// users: baseURL + &#x27;/users&#x27;,</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> api;</span><br></pre></td></tr></table></figure>

<ul>
<li>但是这样使用，每次请求我需要引入两次还要自己组合，所以我们希望将来直接调用一个函数就能请求完成</li>
</ul>
<p>request.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//封装好的请求函数，方便组件/pinia/vuex直接调用</span></span><br><span class="line"><span class="keyword">import</span> http <span class="keyword">from</span> <span class="string">&#x27;./http&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">&#x27;./api&#x27;</span>;</span><br><span class="line"><span class="comment">//获取所有的用户</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getUserApi</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: api.<span class="property">users</span>,</span><br><span class="line">    <span class="comment">// params</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//get请求第二种传递参数方式</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getParamsApi</span>(<span class="params">params</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: api.<span class="property">users</span>,</span><br><span class="line">    params,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//根据id查找某一个用户</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getUserByIdApi</span>(<span class="params">id</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;api.users&#125;</span>/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//新增一个用户</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">addUserApi</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: api.<span class="property">users</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//删除一个用户</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">delUserApi</span>(<span class="params">id</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;DELETE&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;api.users&#125;</span>/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//修改一个用户 patch</span></span><br><span class="line"><span class="comment">//  /users/1</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">editUserApi</span>(<span class="params">id, data</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;PATCH&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;api.users&#125;</span>/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;button @click=&quot;getUsers&quot;&gt;查看所有用户&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;addUser&quot;&gt;新增一个用户&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;getUserById(1)&quot;&gt;根据id查找&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;delUser(2)&quot;&gt;删除id为2的用户&lt;/button&gt;</span><br><span class="line">    &lt;button</span><br><span class="line">      @click=&quot;</span><br><span class="line">        editUser(1, &#123;</span><br><span class="line">          name: &#x27;jesscia&#x27;,</span><br><span class="line">        &#125;)</span><br><span class="line">      &quot;</span><br><span class="line">    &gt;</span><br><span class="line">      修改id为1的用户</span><br><span class="line">    &lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;</span><br><span class="line">  getUserApi,</span><br><span class="line">  addUserApi,</span><br><span class="line">  getUserByIdApi,</span><br><span class="line">  delUserApi,</span><br><span class="line">  editUserApi,</span><br><span class="line">&#125; from &#x27;@/services/request&#x27;;</span><br><span class="line">//修改id为1的用户</span><br><span class="line">const editUser = async (id, data) =&gt; &#123;</span><br><span class="line">  let res = await editUserApi(id, data);</span><br><span class="line">  console.log(res);</span><br><span class="line">&#125;;</span><br><span class="line">//根据id删除一个用户</span><br><span class="line">const delUser = async (id) =&gt; &#123;</span><br><span class="line">  let res = await delUserApi(id);</span><br><span class="line">  console.log(res);</span><br><span class="line">&#125;;</span><br><span class="line">//根据id查找某一个用户</span><br><span class="line">const getUserById = async (id) =&gt; &#123;</span><br><span class="line">  let res = await getUserByIdApi(id);</span><br><span class="line">  console.log(res);</span><br><span class="line">&#125;;</span><br><span class="line">//新增一个用户</span><br><span class="line">const addUser = async () =&gt; &#123;</span><br><span class="line">  let res = await addUserApi(&#123;</span><br><span class="line">    username: &#x27;天河阔少&#x27;,</span><br><span class="line">    password: &#x27;444444&#x27;,</span><br><span class="line">  &#125;);</span><br><span class="line">  console.log(res);</span><br><span class="line">&#125;;</span><br><span class="line">//获取所有用户</span><br><span class="line">const getUsers = async () =&gt; &#123;</span><br><span class="line">  let res = await getUserApi();</span><br><span class="line">  console.log(res);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>s</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://muleandhorse.icu/2022/06/28/b02%20%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E8%85%BE%E8%AE%AF%E4%BA%91cos%E5%AE%9E%E7%8E%B0%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%BB%A5%E5%8F%8A%E9%85%8D%E5%90%88picgo%E5%AE%9E%E7%8E%B0%E5%9B%BE%E5%BA%8A%E5%8A%9F%E8%83%BD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="RickyD">
      <meta itemprop="description" content="如果站长加班加似了，这个网站就是他留给世界最后的遗产">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mule and Horse">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/28/b02%20%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E8%85%BE%E8%AE%AF%E4%BA%91cos%E5%AE%9E%E7%8E%B0%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%BB%A5%E5%8F%8A%E9%85%8D%E5%90%88picgo%E5%AE%9E%E7%8E%B0%E5%9B%BE%E5%BA%8A%E5%8A%9F%E8%83%BD/" class="post-title-link" itemprop="url">如何使用腾讯云cos实现前端性能监控以及配合picgo实现图床功能</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-28 08:00:00" itemprop="dateCreated datePublished" datetime="2022-06-28T08:00:00+08:00">2022-06-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-25 13:08:16" itemprop="dateModified" datetime="2023-03-25T13:08:16+08:00">2023-03-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>4 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这篇文章花费0元，复现时间约2小时（应该）
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/06/28/b02%20%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E8%85%BE%E8%AE%AF%E4%BA%91cos%E5%AE%9E%E7%8E%B0%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%BB%A5%E5%8F%8A%E9%85%8D%E5%90%88picgo%E5%AE%9E%E7%8E%B0%E5%9B%BE%E5%BA%8A%E5%8A%9F%E8%83%BD/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://muleandhorse.icu/2022/06/27/b45%20Vuex/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="RickyD">
      <meta itemprop="description" content="如果站长加班加似了，这个网站就是他留给世界最后的遗产">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mule and Horse">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/27/b45%20Vuex/" class="post-title-link" itemprop="url">vuex状态管理工具</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-27 16:06:09" itemprop="dateCreated datePublished" datetime="2022-06-27T16:06:09+08:00">2022-06-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-07-22 21:11:58" itemprop="dateModified" datetime="2023-07-22T21:11:58+08:00">2023-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Vuex"><a href="#Vuex" class="headerlink" title="Vuex"></a>Vuex</h2><h3 id="1-状态管理"><a href="#1-状态管理" class="headerlink" title="1.状态管理"></a>1.状态管理</h3><h4 id="1-1-什么是状态管理"><a href="#1-1-什么是状态管理" class="headerlink" title="1.1 什么是状态管理"></a>1.1 什么是状态管理</h4><ul>
<li>在开发中，我们的应用程序需要处理各种数据，这些数据需要保存在我们程序中的某一个位置，对于这些数据的管理就叫做状态管理</li>
<li>当我们遇到多组件共享状态时，单向数据流的特点很容易被破坏，多个视图依赖于同一个状态；来自不同视图的行为会修改同一个状态。之前是通过 props&#x2F;emits&#x2F; mitt 库 provide&#x2F;inject 来共享状态，但是对于复杂的状态管理来说往往是一个噩梦，比如兄弟组件如何共享？</li>
</ul>
<h4 id="1-2-vuex-的状态管理"><a href="#1-2-vuex-的状态管理" class="headerlink" title="1.2 vuex 的状态管理"></a>1.2 vuex 的状态管理</h4><ul>
<li>集中式管理，组件内部的状态抽离出来，以一个全局的单例来管理。仪式感比较强，他会通过一系列强制的规则来约束你，使得状态维护起来更加的容易。</li>
</ul>
<p><img src="https://img-1317399399.cos.ap-guangzhou.myqcloud.com//imgimage-20230706154235428.png" alt="image-20230706154235428"></p>
<ul>
<li>State Getters Mutation Action Module</li>
</ul>
<h3 id="2-Vuex-的基本使用"><a href="#2-Vuex-的基本使用" class="headerlink" title="2.Vuex 的基本使用"></a>2.Vuex 的基本使用</h3><h4 id="2-1-安装"><a href="#2-1-安装" class="headerlink" title="2.1 安装"></a>2.1 安装</h4><ul>
<li>安装：npm install vuex</li>
<li>vue2 得安装 3.x 版本 npm install <a href="mailto:&#x76;&#x75;&#x65;&#120;&#x40;&#51;&#x2e;&#120;">&#x76;&#x75;&#x65;&#120;&#x40;&#51;&#x2e;&#120;</a></li>
<li>vue3 得安装 4.x 版本</li>
</ul>
<h4 id="2-2-配置"><a href="#2-2-配置" class="headerlink" title="2.2 配置"></a>2.2 配置</h4><ul>
<li>数据是放在仓库(store)里的</li>
<li>每一个 vuex 的核心就是 store：store 本质上就是一个容器，里面保存着状态以及操作状态的方法</li>
<li>vuex 和全局对象的区别？<ul>
<li>第一：响应式，vuex 的存储是响应式的，组件从 store 读取 state 的时候，如果 state 发生了变化，那么对应组件中的 view 也会变化</li>
<li>第二：你不能直接 store.xxx&#x3D;”123”来修改状态，只能通过 mutation 来修改。</li>
</ul>
</li>
<li>src 目录下新建一个 store 文件夹，里面新建一个 index.js 写入如下内容<br>.&#x2F;store&#x2F;index.js</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//从vuex中引入创建仓库的函数</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span>;</span><br><span class="line"><span class="comment">//创建</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(&#123;</span><br><span class="line">  <span class="comment">//状态</span></span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//暴露出去</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>

<p>main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span>;</span><br><span class="line"><span class="comment">//引入你创建的仓库</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span>;</span><br><span class="line"><span class="comment">//使用仓库</span></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">use</span>(store).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="2-3-使用"><a href="#2-3-使用" class="headerlink" title="2.3 使用"></a>2.3 使用</h4><p>optionAPI</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;这是vue2选项式api的vuex&lt;/h2&gt;</span><br><span class="line">    &lt;!-- 模版中使用 --&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; $store.state.count &#125;&#125;&lt;/h3&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; count &#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  // optionAPI中使用</span><br><span class="line">  computed: &#123;</span><br><span class="line">    count() &#123;</span><br><span class="line">      return this.$store.state.count;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>setup</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;demo-option /&gt;</span><br><span class="line">    &lt;hr /&gt;</span><br><span class="line">    &lt;h2&gt;这是vue3组合式api的vuex&lt;/h2&gt;</span><br><span class="line">    &lt;!-- 模版中使用 --&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; store.state.count &#125;&#125;&lt;/h3&gt;</span><br><span class="line">    &lt;!-- 使用toRefs解构 --&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; count &#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import DemoOption from &#x27;./components/DemoOption.vue&#x27;;</span><br><span class="line">//引入hook</span><br><span class="line">import &#123; useStore &#125; from &#x27;vuex&#x27;;</span><br><span class="line">import &#123; toRefs &#125; from &#x27;vue&#x27;;</span><br><span class="line">//调用上面的函数</span><br><span class="line">const store = useStore();</span><br><span class="line">const &#123; count &#125; = toRefs(store.state);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="3-核心-State"><a href="#3-核心-State" class="headerlink" title="3.核心 State"></a>3.核心 State</h3><ul>
<li>state 就是我们存放多个组件都需要用到的数据的地方，有点像 data</li>
</ul>
<h4 id="3-1-组件获取状态"><a href="#3-1-组件获取状态" class="headerlink" title="3.1 组件获取状态"></a>3.1 组件获取状态</h4><ul>
<li>默认我们获取状态都需先获取到 store 然后获取 store 里面的 state 再获取 state 的属性，比较冗余</li>
</ul>
<h4 id="3-2-mapState-的使用"><a href="#3-2-mapState-的使用" class="headerlink" title="3.2 mapState 的使用"></a>3.2 mapState 的使用</h4><ul>
<li>vuex 提供给我们一个辅助函数方便我们取出并展示其中的数据 mapState 辅助函数</li>
</ul>
<p>option</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;这是vue2选项式api的vuex&lt;/h2&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; count &#125;&#125;--&#123;&#123; name &#125;&#125;--&#123;&#123; level &#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; mapState &#125; from &#x27;vuex&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  // optionAPI中使用</span><br><span class="line">  computed: &#123;</span><br><span class="line">    //第一种数组语法</span><br><span class="line">    // ...mapState([&#x27;count&#x27;, &#x27;name&#x27;, &#x27;level&#x27;]),</span><br><span class="line">    //第二种对象的语法</span><br><span class="line">    ...mapState(&#123;</span><br><span class="line">      name: (state) =&gt; state.name,</span><br><span class="line">      count: (state) =&gt; state.count,</span><br><span class="line">      level: (state) =&gt; state.level,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>如果是在 setup 中使用，得自己一个个处理$store 的问题，如果不想手动一个个处理，可以封装一个 hook</li>
</ul>
<p>useState.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//自动处理mapState</span></span><br><span class="line"><span class="keyword">import</span> &#123; useStore, mapState &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; computed &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useState</span>(<span class="params">mapper</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> store = <span class="title function_">useStore</span>();</span><br><span class="line">  <span class="keyword">const</span> tempState = <span class="title function_">mapState</span>(mapper);</span><br><span class="line">  <span class="comment">//处理$store</span></span><br><span class="line">  <span class="keyword">const</span> newState = &#123;&#125;;</span><br><span class="line">  <span class="comment">//遍历拿到对象的所有的key</span></span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">keys</span>(tempState).<span class="title function_">forEach</span>(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">    newState[key] = <span class="title function_">computed</span>(tempState[key].<span class="title function_">bind</span>(&#123; <span class="attr">$store</span>: store &#125;));</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> newState;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;demo-option /&gt;</span><br><span class="line">    &lt;hr /&gt;</span><br><span class="line">    &lt;h2&gt;这是vue3组合式api的vuex&lt;/h2&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; count &#125;&#125;--&#123;&#123; name &#125;&#125;--&#123;&#123; level &#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import DemoOption from &#x27;./components/DemoOption.vue&#x27;;</span><br><span class="line">import useState from &#x27;./hooks/useState&#x27;;</span><br><span class="line">const &#123; count, name, level &#125; = useState([&#x27;name&#x27;, &#x27;count&#x27;, &#x27;level&#x27;]);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="4-核心-Getters"><a href="#4-核心-Getters" class="headerlink" title="4.核心 Getters"></a>4.核心 Getters</h3><ul>
<li>getters 类似 computed，某些状态我们可能不是直接使用，而是需要经过一点复杂的逻辑处理后使用</li>
</ul>
<h4 id="4-1-基本使用"><a href="#4-1-基本使用" class="headerlink" title="4.1 基本使用"></a>4.1 基本使用</h4><ul>
<li>修改仓库中 的数据</li>
</ul>
<p>store&#x2F;index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//从vuex中引入创建仓库的函数</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span>;</span><br><span class="line"><span class="comment">//创建</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(&#123;</span><br><span class="line">  <span class="comment">//状态</span></span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">level</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;alex&#x27;</span>,</span><br><span class="line">    <span class="attr">books</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;vuejs&#x27;</span>,</span><br><span class="line">        <span class="attr">price</span>: <span class="number">100</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;react&#x27;</span>,</span><br><span class="line">        <span class="attr">price</span>: <span class="number">200</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;webpack&#x27;</span>,</span><br><span class="line">        <span class="attr">price</span>: <span class="number">300</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//类似计算属性</span></span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="comment">//计算书的总价,默认有一个参数叫做state</span></span><br><span class="line">    <span class="title function_">totalPrice</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.<span class="property">books</span>.<span class="title function_">reduce</span>(<span class="function">(<span class="params">prev, item</span>) =&gt;</span> prev + item.<span class="property">price</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//暴露出去</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>

<p>options 中使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;这是vue2选项式api的vuex&lt;/h2&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li v-for=&quot;item in books&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">        &#123;&#123; item.name &#125;&#125;--&#123;&#123; item.price &#125;&#125;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">    &lt;p&gt;总价:&#123;&#123; $store.getters.totalPrice &#125;&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  // optionAPI中使用</span><br><span class="line">  computed: &#123;</span><br><span class="line">    books() &#123;</span><br><span class="line">      return this.$store.state.books;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>setup 中使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;demo-option /&gt;</span><br><span class="line">    &lt;hr /&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li v-for=&quot;item in books&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">        &#123;&#123; item.name &#125;&#125;--&#123;&#123; item.price &#125;&#125;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">    &lt;p&gt;总价:&#123;&#123; $store.getters.totalPrice &#125;&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import DemoOption from &#x27;./components/DemoOption.vue&#x27;;</span><br><span class="line">import &#123; useStore &#125; from &#x27;vuex&#x27;;</span><br><span class="line">import &#123; toRefs &#125; from &#x27;vue&#x27;;</span><br><span class="line">const store = useStore();</span><br><span class="line">const &#123; books &#125; = toRefs(store.state);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-getters-传递参数"><a href="#4-2-getters-传递参数" class="headerlink" title="4.2 getters 传递参数"></a>4.2 getters 传递参数</h4><ul>
<li>和计算属性类似</li>
<li>修改 getters 使得能够传递参数</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="comment">//我是一个黑商，我会把每本书的单价翻倍</span></span><br><span class="line">    <span class="title function_">totalPrice</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="function">(<span class="params">money</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> state.<span class="property">books</span>.<span class="title function_">reduce</span>(<span class="function">(<span class="params">prev, item</span>) =&gt;</span> prev + item.<span class="property">price</span> * money, <span class="number">0</span>);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// totalPrice(state) &#123;</span></span><br><span class="line">    <span class="comment">//   return state.books.reduce((prev, item) =&gt; prev + item.price, 0);</span></span><br><span class="line">    <span class="comment">// &#125;,</span></span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p>使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;总价:&#123;&#123; $store.getters.totalPrice(1) &#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;黑商总价:&#123;&#123; $store.getters.totalPrice(3) &#125;&#125;&lt;/p&gt;</span><br></pre></td></tr></table></figure>

<p>练习：根据书名找书</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据书名找到整本书的对象返回给我</span></span><br><span class="line">   <span class="title function_">findByName</span>(<span class="params">state</span>) &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> state.<span class="property">books</span>.<span class="title function_">find</span>(<span class="function">(<span class="params">ele</span>) =&gt;</span> ele.<span class="property">name</span> === name);</span><br><span class="line">     &#125;;</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<h4 id="4-3-mapGetters-辅助函数"><a href="#4-3-mapGetters-辅助函数" class="headerlink" title="4.3 mapGetters 辅助函数"></a>4.3 mapGetters 辅助函数</h4><p>option 中使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;这是vue2选项式api的vuex&lt;/h2&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li v-for=&quot;item in books&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">        &#123;&#123; item.name &#125;&#125;--&#123;&#123; item.price &#125;&#125;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">    &lt;p&gt;总价:&#123;&#123; totalPrice(1) &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;黑商总价:&#123;&#123; totalPrice(3) &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;找书:&#123;&#123; findByName(&#x27;react&#x27;) &#125;&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; mapGetters &#125; from &#x27;vuex&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  // optionAPI中使用</span><br><span class="line">  computed: &#123;</span><br><span class="line">    ...mapGetters([&#x27;totalPrice&#x27;, &#x27;findByName&#x27;]),</span><br><span class="line">    books() &#123;</span><br><span class="line">      return this.$store.state.books;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>setup 中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;demo-option /&gt;</span><br><span class="line">    &lt;hr /&gt;</span><br><span class="line">    &lt;p&gt;总价:&#123;&#123; totalPrice(1) &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;黑商总价:&#123;&#123; totalPrice(3) &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;!-- &lt;p&gt;找书:&#123;&#123; findByName(&#x27;react&#x27;) &#125;&#125;&lt;/p&gt; --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import DemoOption from &#x27;./components/DemoOption.vue&#x27;;</span><br><span class="line">import &#123; useStore &#125; from &#x27;vuex&#x27;;</span><br><span class="line">import &#123; toRefs, computed &#125; from &#x27;vue&#x27;;</span><br><span class="line">const store = useStore();</span><br><span class="line">//使用bind 手动处理/自己写一个hook</span><br><span class="line">//state是自己写的$store处理，getters又不用</span><br><span class="line">//可以直接使用toRefs解构</span><br><span class="line">// const &#123; totalPrice, findByName &#125; = toRefs(store.getters);</span><br><span class="line">//只想要totalPirce</span><br><span class="line">const totalPrice = computed(() =&gt; store.getters.totalPrice);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="5-Mutations"><a href="#5-Mutations" class="headerlink" title="5.Mutations"></a>5.Mutations</h3><ul>
<li>为了保证数据的变化是可控的，我们只能使用 mutation 来修改数据<br>计数器</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mutations</span>: &#123;</span><br><span class="line">  <span class="comment">//第一个参数是state</span></span><br><span class="line">  <span class="comment">//payload是我们将来调用的时候传入的参数</span></span><br><span class="line">  <span class="title function_">add</span>(<span class="params">state, payload</span>) &#123;</span><br><span class="line">    state.<span class="property">count</span> += payload;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">sub</span>(<span class="params">state, payload</span>) &#123;</span><br><span class="line">    state.<span class="property">count</span> -= payload;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>optionAPI</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;这是vue2选项式api的vuex&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;当前计数:&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;addHandle&quot;&gt;+&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;subHandle&quot;&gt;-&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; mapState &#125; from &#x27;vuex&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  // optionAPI中使用</span><br><span class="line">  computed: &#123;</span><br><span class="line">    ...mapState([&#x27;count&#x27;]),</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    //不能直接调用mutation而是类似自定义事件的用法</span><br><span class="line">    addHandle() &#123;</span><br><span class="line">      this.$store.commit(&#x27;add&#x27;, 5);</span><br><span class="line">    &#125;,</span><br><span class="line">    subHandle() &#123;</span><br><span class="line">      this.$store.commit(&#x27;sub&#x27;, 5);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>setup</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;demo-option /&gt;</span><br><span class="line">    &lt;hr /&gt;</span><br><span class="line">    &lt;h2&gt;当前计数:&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;addHandle&quot;&gt;+&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;subHandle&quot;&gt;-&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import DemoOption from &#x27;./components/DemoOption.vue&#x27;;</span><br><span class="line">import &#123; useStore &#125; from &#x27;vuex&#x27;;</span><br><span class="line">import &#123; toRefs, computed &#125; from &#x27;vue&#x27;;</span><br><span class="line">const store = useStore();</span><br><span class="line">const &#123; count &#125; = toRefs(store.state);</span><br><span class="line">const addHandle = () =&gt; &#123;</span><br><span class="line">  store.commit(&#x27;add&#x27;, 5);</span><br><span class="line">&#125;;</span><br><span class="line">const subHandle = () =&gt; &#123;</span><br><span class="line">  store.commit(&#x27;sub&#x27;, 5);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>mapMutation 辅助函数</li>
<li>因为 setup 中 commit 的时候已经相对比较简短了，所以不需要 mapMutation</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;这是vue2选项式api的vuex&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;当前计数:&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;add(5)&quot;&gt;+&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;sub(5)&quot;&gt;-&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; mapState, mapMutations &#125; from &#x27;vuex&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  // optionAPI中使用</span><br><span class="line">  computed: &#123;</span><br><span class="line">    //state/getters用辅助函数映射以后解构到计算属性</span><br><span class="line">    ...mapState([&#x27;count&#x27;]),</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    //mapMutation返回的对象应该解构到methods中</span><br><span class="line">    ...mapMutations([&#x27;add&#x27;, &#x27;sub&#x27;]),</span><br><span class="line">    // addHandle()&#123;</span><br><span class="line">    //   this.add(5)</span><br><span class="line">    // &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>mutation 有一个重要原则：不要执行异步</li>
</ul>
<h3 id="6-核心-Actions"><a href="#6-核心-Actions" class="headerlink" title="6.核心 Actions"></a>6.核心 Actions</h3><ul>
<li>专门用来处理异步，action 不要修改数据，数据的修改只能交给 mutation，在组件中调用 action 叫做分发 dispatch</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">actions</span>: &#123;</span><br><span class="line">   <span class="comment">// //如果遇到封装好的请求函数</span></span><br><span class="line">   <span class="comment">// async getRes(context) &#123;</span></span><br><span class="line">   <span class="comment">//   let result = await request(&#x27;url&#x27;);</span></span><br><span class="line">   <span class="comment">//   // context.res= result</span></span><br><span class="line">   <span class="comment">//   context.commit(&#x27;xxx&#x27;,result)</span></span><br><span class="line">   <span class="comment">// &#125;,</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">//第一个参数context能够获取到state，mutation，getters</span></span><br><span class="line">   <span class="comment">//payload将来dispatch的时候传入的参数</span></span><br><span class="line">   <span class="title function_">addAction</span>(<span class="params">context, payload</span>) &#123;</span><br><span class="line">     <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">       context.<span class="title function_">commit</span>(<span class="string">&#x27;add&#x27;</span>, <span class="number">5</span>);</span><br><span class="line">     &#125;, payload);</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="title function_">subAction</span>(<span class="params">context, payload</span>) &#123;</span><br><span class="line">     <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">       context.<span class="title function_">commit</span>(<span class="string">&#x27;sub&#x27;</span>, <span class="number">5</span>);</span><br><span class="line">     &#125;, payload);</span><br><span class="line">   &#125;,</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<p>optionAPI</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;这是vue2选项式api的vuex&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;当前计数:&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;addHandle&quot;&gt;+&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;subHandle&quot;&gt;-&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; mapState, mapMutations &#125; from &#x27;vuex&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  // optionAPI中使用</span><br><span class="line">  computed: &#123;</span><br><span class="line">    //state/getters用辅助函数映射以后解构到计算属性</span><br><span class="line">    ...mapState([&#x27;count&#x27;]),</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    addHandle() &#123;</span><br><span class="line">      this.$store.dispatch(&#x27;addAction&#x27;, 1000);</span><br><span class="line">    &#125;,</span><br><span class="line">    subHandle() &#123;</span><br><span class="line">      this.$store.dispatch(&#x27;subAction&#x27;, 1000);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>setup</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;demo-option /&gt;</span><br><span class="line">    &lt;hr /&gt;</span><br><span class="line">    &lt;h2&gt;当前计数:&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;addHandle&quot;&gt;+&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;subHandle&quot;&gt;-&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import DemoOption from &#x27;./components/DemoOption.vue&#x27;;</span><br><span class="line">import &#123; useStore &#125; from &#x27;vuex&#x27;;</span><br><span class="line">import &#123; toRefs, computed &#125; from &#x27;vue&#x27;;</span><br><span class="line">const store = useStore();</span><br><span class="line">const &#123; count &#125; = toRefs(store.state);</span><br><span class="line">const addHandle = () =&gt; &#123;</span><br><span class="line">  store.dispatch(&#x27;addAction&#x27;, 1000);</span><br><span class="line">&#125;;</span><br><span class="line">const subHandle = () =&gt; &#123;</span><br><span class="line">  store.dispatch(&#x27;subAction&#x27;, 1000);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>mapAction 的辅助函数方便快速解构出 action</li>
</ul>
<p>optionAPI</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;这是vue2选项式api的vuex&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;当前计数:&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;addAction(1000)&quot;&gt;+&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;subAction(1000)&quot;&gt;-&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; mapState, mapActions &#125; from &#x27;vuex&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  // optionAPI中使用</span><br><span class="line">  computed: &#123;</span><br><span class="line">    //state/getters用辅助函数映射以后解构到计算属性</span><br><span class="line">    ...mapState([&#x27;count&#x27;]),</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    ...mapActions([&#x27;addAction&#x27;, &#x27;subAction&#x27;]),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>写一个计数器，能加能减，能延迟加，延迟减,并且有一个 getters 是把 count 翻倍</li>
<li>看群文件“计数器 vuex 版本”–有个作业封装 mapAction 的 hook</li>
</ul>
<p>useAction.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useStore, mapActions &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useAction</span>(<span class="params">moduleName, mapper</span>) &#123;</span><br><span class="line">  <span class="comment">//获取vuex</span></span><br><span class="line">  <span class="keyword">const</span> store = <span class="title function_">useStore</span>();</span><br><span class="line">  <span class="keyword">const</span> actions = <span class="title function_">mapActions</span>(moduleName, mapper);</span><br><span class="line">  <span class="keyword">const</span> newActions = &#123;&#125;;</span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">keys</span>(mutations).<span class="title function_">forEach</span>(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">    newActions[key] = actions[key].<span class="title function_">bind</span>(&#123; <span class="attr">$store</span>: store &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> newActions;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-Modules"><a href="#7-Modules" class="headerlink" title="7.Modules"></a>7.Modules</h3><ul>
<li>vuex 提供了模块化，每个模块有自己的 state，mutation，action，getters…而且互不冲突</li>
<li>namespaced:true 开启命名空间，这样哪怕不同的模块有同样名字的 state</li>
<li>第二个作业：vuex 模块化版本购物车 setup 的</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://muleandhorse.icu/2022/06/26/b44%20Composition%20API/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="RickyD">
      <meta itemprop="description" content="如果站长加班加似了，这个网站就是他留给世界最后的遗产">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mule and Horse">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/26/b44%20Composition%20API/" class="post-title-link" itemprop="url">vue组合式api</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-26 16:06:09" itemprop="dateCreated datePublished" datetime="2022-06-26T16:06:09+08:00">2022-06-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-07-22 21:11:25" itemprop="dateModified" datetime="2023-07-22T21:11:25+08:00">2023-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.8k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>13 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="07-03-Composition-API"><a href="#07-03-Composition-API" class="headerlink" title="07-03 Composition API"></a><strong>07-03 Composition API</strong></h1><h2 id="1-Options-API和Composition-API"><a href="#1-Options-API和Composition-API" class="headerlink" title="1. Options API和Composition API"></a>1. <strong>Options API和Composition API</strong></h2><h3 id="1-1-Options-API的弊端"><a href="#1-1-Options-API的弊端" class="headerlink" title="1.1 Options API的弊端"></a><strong>1.1 Options API的弊端</strong></h3><p>实现某一个功能的时候，同一个功能的代码逻辑被<strong>拆分</strong>开了，而且当项目&#x2F;组件变得比较大时，我们对应的选项中的代码会变的非常的多，对于使用这些组件的人来说，往往是比较难阅读的。composition API解决的问题，Vue Compostion API 有人称为VCA</p>
<h3 id="1-2-体验composition-API"><a href="#1-2-体验composition-API" class="headerlink" title="1.2 体验composition API"></a><strong>1.2 体验composition API</strong></h3><p>在vue中组合式api他的使用其实就是一个setup的函数而已，他也是一个选项；只不过这个选项相对强大一点。可以用来替代之前的大部分其他选项。</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; count &#125;&#125;h2&gt;</span><br><span class="line">    &lt;button @click=&quot;add&quot;&gt;+button&gt;</span><br><span class="line">    &lt;button @click=&quot;sub&quot;&gt;-button&gt;</span><br><span class="line">  div&gt;</span><br><span class="line">template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import useCount from &#x27;./hooks/useCount&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    //使用组合式api</span><br><span class="line">    //并不是所有的变量都需要交给vue来做响应式</span><br><span class="line">    //vue3 组合式api 让开发者决定那些需要响应式 而不是像options 一样 只要写到data中就就会去做响应式</span><br><span class="line">    //数据来源更加明确的写法</span><br><span class="line">    const &#123;count,add,sub&#125;=useCount()</span><br><span class="line">    return &#123;</span><br><span class="line">    //计数器的逻辑</span><br><span class="line">      ...useCount(),</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;style&gt;</span><br></pre></td></tr></table></figure>





<p>hooks&#x2F;count.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//实现计数器逻辑</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default function useCount() &#123;</span><br><span class="line">  const count = ref(0);</span><br><span class="line">  const add = () =&gt; &#123;</span><br><span class="line">    count.value++;</span><br><span class="line">  &#125;;</span><br><span class="line">  const sub = () =&gt; &#123;</span><br><span class="line">    count.value--;</span><br><span class="line">  &#125;;</span><br><span class="line">  return &#123;</span><br><span class="line">    count,</span><br><span class="line">    add,</span><br><span class="line">    sub,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>一句话总结组合式api：函数式编程的体现，就是在setup函数里面写代码</p>
<h2 id="2-setup"><a href="#2-setup" class="headerlink" title="2. setup"></a>2. <strong>setup</strong></h2><p>setup中禁用this</p>
<h3 id="2-1-setup函数的参数"><a href="#2-1-setup函数的参数" class="headerlink" title="2.1 setup函数的参数"></a><strong>2.1 setup函数的参数</strong></h3><p>第一个参数 props</p>
<p>父传子，子接收用的</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;home :msg=&quot;msg&quot; /&gt;</span><br><span class="line">    &lt;hr /&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; msg &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;change&quot;&gt;修改msg&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Home from &#x27;./components/Home.vue&#x27;;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">  &#125;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const msg = ref(&#x27;alex&#x27;);</span><br><span class="line">    const change = () =&gt; &#123;</span><br><span class="line">      msg.value = &#x27;天河阔少&#x27;;</span><br><span class="line">    &#125;;</span><br><span class="line">    return &#123; msg, change &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>Home</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;Home组件&lt;/h2&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; msg &#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    msg: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  setup(props) &#123;</span><br><span class="line">    //setup中禁用this，我们都会有替代方案</span><br><span class="line">    // console.log(props.msg);</span><br><span class="line">    //不能解构props 会丢失响应式</span><br><span class="line">    const &#123; msg &#125; = props;</span><br><span class="line">    return &#123;</span><br><span class="line">      msg,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>第二个参数 context</p>
<p>​	他有三个属性</p>
<p>​	attrs：所有的非props的属性</p>
<p>​	slots：父组件插槽传递</p>
<p>​	emit：因为我们不能使用this，通过这种替代方案给你emit</p>
<h3 id="2-2-setup-返回值"><a href="#2-2-setup-返回值" class="headerlink" title="2.2 setup 返回值"></a><strong>2.2 setup 返回值</strong></h3><p>setup的返回值可以在模版中使用，我们可以通过setup的返回值来替代data选项，返回的一个函数替代了methods选项</p>
<p>额外的：在vue2也有复用代码的手段，mixins混入</p>
<p>mixins的缺点</p>
<ol>
<li>变量来源不明确，不利于阅读，代码维护负担大</li>
</ol>
<p>组件里面可能有多个mixins，并且会使用mixins中的变量&#x2F;函数，这些变量&#x2F;函数到底来自那个mixins，还是说是自己的？</p>
<ol start="2">
<li><p>多个mixins的生命周期会混到一起，但是同名的属性&#x2F;方法名无法融合的，可能会导致冲突</p>
</li>
<li><p>mixins和组件之间可能会出现多对多的情况，复杂度比较高。</p>
</li>
</ol>
<h2 id="3-定义数据"><a href="#3-定义数据" class="headerlink" title="3. 定义数据"></a>3. <strong>定义数据</strong></h2><h3 id="3-1-reactive"><a href="#3-1-reactive" class="headerlink" title="3.1 reactive"></a><strong>3.1 reactive</strong></h3><p>为什么用reactive以后，我们的数据就变成响应式，因为一旦使用了reactive处理以后，你的数据再次使用的时候就会收集依赖，当数据发生改变的时候就会进行对应的响应式操作，实际上我们之前写的data在vue内部是遍历以后交给reactive来处理的。</p>
<p>如果用reactive定义简单数据类型的响应式，会报一个警告</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; msg &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; acount.username &#125;&#125;--&#123;&#123; acount.password &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;msg += &#x27;alex&#x27;&quot;&gt;修改&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;change&quot;&gt;修改account&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">//如果想使用reactive得引入</span><br><span class="line">import &#123; reactive &#125; from &#x27;vue&#x27;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    //定义普通的数据，可以正常使用</span><br><span class="line">    //缺点：没有响应式</span><br><span class="line">    let msg = &#x27;hello world&#x27;;</span><br><span class="line">    //定义响应式的数据</span><br><span class="line">    //reactive:定义复杂类型类型的数据</span><br><span class="line">    const acount = reactive(&#123;</span><br><span class="line">      username: &#x27;alex&#x27;,</span><br><span class="line">      password: &#x27;123456&#x27;,</span><br><span class="line">    &#125;);</span><br><span class="line">    const change = () =&gt; &#123;</span><br><span class="line">      acount.username = &#x27;天河阔少&#x27;;</span><br><span class="line">    &#125;;</span><br><span class="line">    return &#123;</span><br><span class="line">      msg,</span><br><span class="line">      acount,</span><br><span class="line">      change,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="3-2-ref"><a href="#3-2-ref" class="headerlink" title="3.2 ref"></a><strong>3.2 ref</strong></h3><p>reactive API要求我们必须传入对象&#x2F;数组类型的数据，如果传入一个基本类型会报警告而且不生效。如果我们要定义基本类型的响应式变量就得使用 ref，ref内部会返回一个不可变的响应式对象，该对象作为一个响应式的引用维护着他内部的值。ref在模版中使用会自动解包，但是在setup中修改时需要使用.value</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;!-- 在模版中使用ref时，vue会自动解包,自动取出其中的value --&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;add&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;sub&quot;&gt;-1&lt;/button&gt;</span><br><span class="line">    &lt;h2&gt;info:&#123;&#123; info.count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;!-- 修改 --&gt;</span><br><span class="line">    &lt;button @click=&quot;info.count++&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;info.count.value++&quot;&gt;能够+1&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    //ref:定义简单类型的数据(也可以定义复杂类型)</span><br><span class="line">    //count就是响应式的</span><br><span class="line">    const count = ref(0);</span><br><span class="line">    console.log(count);</span><br><span class="line">    const add = () =&gt; &#123;</span><br><span class="line">      //在setup中使用，得自己加上.value</span><br><span class="line">      count.value++;</span><br><span class="line">    &#125;;</span><br><span class="line">    const sub = () =&gt; &#123;</span><br><span class="line">      count.value--;</span><br><span class="line">    &#125;;</span><br><span class="line">    //ref是浅层解包(了解，真实开发不会这样去写)</span><br><span class="line">    const info = &#123;</span><br><span class="line">      // count:count,</span><br><span class="line">      count,</span><br><span class="line">    &#125;;</span><br><span class="line">    return &#123;</span><br><span class="line">      count,</span><br><span class="line">      add,</span><br><span class="line">      sub,</span><br><span class="line">      info,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>ref和reactive的选择，个人经验：ref用的多</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; info &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changeInfo&quot;&gt;修改info&lt;/button&gt;</span><br><span class="line">    &lt;hr /&gt;</span><br><span class="line">    &lt;form action=&quot;&quot;&gt;</span><br><span class="line">      账号：&lt;input type=&quot;text&quot; v-model=&quot;account.username&quot; /&gt; 密码</span><br><span class="line">      &lt;input type=&quot;password&quot; v-model=&quot;account.password&quot; /&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref, reactive &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    //强调:ref也可以定义复杂数据类型</span><br><span class="line">    const info = ref(&#123; name: &#x27;alex&#x27; &#125;);</span><br><span class="line">    // info.value = &#123;&#125;;</span><br><span class="line">    function changeInfo() &#123;</span><br><span class="line">      info.value.name = &#x27;天河阔少&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    //1. reactive的应用场景</span><br><span class="line">    //1.1 本地数据</span><br><span class="line">    //1.2 表单 多个数据之间有关系/联系(聚合的数据，组织在一起会有特定的作用)</span><br><span class="line">    // const list = reactive([&#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;]);</span><br><span class="line">    const account = reactive(&#123;</span><br><span class="line">      username: &#x27;alex&#x27;,</span><br><span class="line">      password: &#x27;123&#x27;,</span><br><span class="line">    &#125;);</span><br><span class="line">    // const username = ref(&#x27;alex&#x27;);</span><br><span class="line">    // const password = ref(&#x27;123&#x27;);</span><br><span class="line">    //其他情况 统一用ref</span><br><span class="line">    //请求</span><br><span class="line">    // const musics = reactive([]);</span><br><span class="line">    const musics = ref([]);</span><br><span class="line">    const serverMusic = [&#x27;红日&#x27;, &#x27;海阔天空&#x27;, &#x27;护花使者&#x27;];</span><br><span class="line">    //如果reactive我要把数组赋值给他 遍历塞push进去</span><br><span class="line">    //ref就很方便</span><br><span class="line">    musics.value = serverMusic;</span><br><span class="line">    return &#123; info, changeInfo, account &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="3-3-readonly"><a href="#3-3-readonly" class="headerlink" title="3.3 readonly"></a><strong>3.3 readonly</strong></h3><p>为了严格保持单项数据流而生，如果你写的时候已经遵循了单项数据流，那么也可以不用这个函数，返回原始对象的只读代理，本质上readonly返回对象的setter被劫持</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;自己的info:&#123;&#123; info &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;home :info=&quot;info&quot; :roInfo=&quot;roInfo&quot; @changeInfo=&quot;changeInfo&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; reactive, readonly &#125; from &#x27;vue&#x27;;</span><br><span class="line">import Home from &#x27;./components/Home.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">  &#125;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const info = reactive(&#123;</span><br><span class="line">      name: &#x27;alex&#x27;,</span><br><span class="line">      age: 18,</span><br><span class="line">      height: 1.88,</span><br><span class="line">    &#125;);</span><br><span class="line">    //合规的单项的数据流</span><br><span class="line">    const changeInfo = (payload) =&gt; &#123;</span><br><span class="line">      info.name = payload;</span><br><span class="line">    &#125;;</span><br><span class="line">    const roInfo = readonly(info);</span><br><span class="line">    return &#123; info, changeInfo, roInfo &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Home.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;home的info:&#123;&#123; info &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;!-- 能实现修改，但是禁止这样不符合单项数据流 --&gt;</span><br><span class="line">    &lt;button @click=&quot;info.name = &#x27;jack&#x27;&quot;&gt;违规修改props&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeInfo&quot;&gt;合法修改props&lt;/button&gt;</span><br><span class="line">    &lt;hr /&gt;</span><br><span class="line">    &lt;h2&gt;只读的info:&#123;&#123; roInfo &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;roInfo.name = &#x27;tom&#x27;&quot;&gt;修改只读&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    info: &#123;</span><br><span class="line">      type: Object,</span><br><span class="line">      default: () =&gt; &#123;&#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    roInfo: &#123;</span><br><span class="line">      type: Object,</span><br><span class="line">      default: () =&gt; &#123;&#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  setup(props, context) &#123;</span><br><span class="line">    const changeInfo = () =&gt; &#123;</span><br><span class="line">      // console.log(this);</span><br><span class="line">      context.emit(&#x27;changeInfo&#x27;, &#x27;jack&#x27;);</span><br><span class="line">    &#125;;</span><br><span class="line">    return &#123; changeInfo &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-4-toRefs、toRef"><a href="#3-4-toRefs、toRef" class="headerlink" title="3.4 toRefs、toRef"></a><strong>3.4 toRefs、toRef</strong></h3><p>解决 解构时响应式丢失</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;home :info=&quot;info&quot; /&gt;</span><br><span class="line">    &lt;hr /&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; name &#125;&#125;--&#123;&#123; age &#125;&#125;--&#123;&#123; gaodu &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;age++&quot;&gt;修改age&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;gaodu = 1.99&quot;&gt;修改height&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Home from &#x27;./components/Home.vue&#x27;;</span><br><span class="line">import &#123; reactive, toRefs, toRef &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">  &#125;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const info = reactive(&#123;</span><br><span class="line">      name: &#x27;alex&#x27;,</span><br><span class="line">      age: 18,</span><br><span class="line">      height: 1.88,</span><br><span class="line">    &#125;);</span><br><span class="line">    // const &#123; name, age, height &#125; = info;</span><br><span class="line">    //name,age都变成响应式</span><br><span class="line">    const &#123; name, age &#125; = toRefs(info);</span><br><span class="line">    //单独某个属性变成响应式</span><br><span class="line">    const gaodu = toRef(info, &#x27;height&#x27;);</span><br><span class="line">    return &#123;</span><br><span class="line">      info,</span><br><span class="line">      name,</span><br><span class="line">      age,</span><br><span class="line">      gaodu,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Home.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;&#123;&#123; name &#125;&#125;--&#123;&#123; age &#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; toRefs &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    info: &#123;</span><br><span class="line">      type: Object,</span><br><span class="line">      default: () =&gt; &#123;&#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  setup(props) &#123;</span><br><span class="line">    //解构props并展示，而且不要丢失响应式</span><br><span class="line">    // const &#123; name, age &#125; = props.info;</span><br><span class="line">    const &#123; name, age &#125; = toRefs(props.info);</span><br><span class="line">    return &#123; name, age &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-5-其他API"><a href="#3-5-其他API" class="headerlink" title="3.5 其他API"></a><strong>3.5 其他API</strong></h3><p>unref</p>
<p>​	如果参数是一个ref就返回value，如果不是就返回参数本身</p>
<p>isRef</p>
<p>​	判断是否是一个ref对象</p>
<p>shallowRef</p>
<p>​	创建一个浅层的ref对象</p>
<p>triggerRef</p>
<p>​	手动触发shallowRef的副作用</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; msg &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;edit&quot;&gt;修改&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; shallowRef, triggerRef &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const msg = shallowRef(&#123; name: &#x27;alex&#x27; &#125;);</span><br><span class="line">    const edit = () =&gt; &#123;</span><br><span class="line">      msg.value.name = &#x27;天河阔少&#x27;;</span><br><span class="line">      // msg.value = &#123;</span><br><span class="line">      //   name: &#x27;天河阔少&#x27;,</span><br><span class="line">      // &#125;;</span><br><span class="line">      triggerRef(msg);</span><br><span class="line">    &#125;;</span><br><span class="line">    return &#123; msg, edit &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>具体使用场景：<a target="_blank" rel="noopener" href="https://juejin.cn/post/7194516447932973112#heading-14">https://juejin.cn/post/7194516447932973112#heading-14</a></p>
<h2 id="4-setup中禁用this"><a href="#4-setup中禁用this" class="headerlink" title="4. setup中禁用this"></a>4. <strong>setup中禁用this</strong></h2><p>在setup中避免使用this，因为会得到undefined。所有之前的this.xxx我们都有替代方案，但是关于this不能使用的本质原因，有很多争议</p>
<p>常见的错误结论 ：setup是在beforeCreate和created之前调用的，所以在这个时候组件实例还没有被创建出来，因此不能是用this</p>
<p>vue源码的处理过程</p>
<ol>
<li><p>调用<strong>createComponentInstance</strong>创建组件实例</p>
</li>
<li><p>调用<strong>setupComponent</strong>函数初始化组件内部的操作，初始化data，methods…</p>
</li>
<li><p>调用<strong>setupStatefulComponent</strong>初始化有状态的组件</p>
</li>
<li><p>通过<strong>setupStatefulComponent取出</strong>setup函数，交给<strong>callWithErrorHanding</strong>执行</p>
</li>
</ol>
<p>真正的原因并不是组件没有创建出来，而是在执行整个带有setup语法的组件的时候没有执行类似vue2的通过bind绑定组件实例的过程。</p>
<h2 id="5-setup中的computed"><a href="#5-setup中的computed" class="headerlink" title="5. setup中的computed"></a>5. <strong>setup中的computed</strong></h2><p>方式一：简写</p>
<p>接收一个getter函数，并且值为getter函数的返回值</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; fullName &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; scoreLevel &#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; reactive, ref, computed &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    //定义数据</span><br><span class="line">    const names = reactive(&#123;</span><br><span class="line">      firstName: &#x27;alex&#x27;,</span><br><span class="line">      lastName: &#x27;小肥君&#x27;,</span><br><span class="line">    &#125;);</span><br><span class="line">    const fullName = computed(() =&gt; &#123;</span><br><span class="line">      return names.firstName + &#x27; &#x27; + names.lastName;</span><br><span class="line">    &#125;);</span><br><span class="line">    //定义分数</span><br><span class="line">    const score = ref(90);</span><br><span class="line">    //定义分数的计算属性 根据分数判断是否及格</span><br><span class="line">    const scoreLevel = computed(() =&gt; (score.value &gt;= 60 ? &#x27;及格&#x27; : &#x27;不及格&#x27;));</span><br><span class="line">    return &#123; fullName, scoreLevel &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>方式二：完整写法</p>
<p>具有setter和getter的对象</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; fullName &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;setFullName&quot;&gt;设置name&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; reactive, ref, computed &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    //定义数据</span><br><span class="line">    const names = reactive(&#123;</span><br><span class="line">      firstName: &#x27;alex&#x27;,</span><br><span class="line">      lastName: &#x27;小肥君&#x27;,</span><br><span class="line">    &#125;);</span><br><span class="line">    //computed函数返回的是一个ref</span><br><span class="line">    // const fullName = computed(() =&gt; &#123;</span><br><span class="line">    //   return names.firstName + &#x27; &#x27; + names.lastName;</span><br><span class="line">    // &#125;);</span><br><span class="line">    const fullName = computed(&#123;</span><br><span class="line">      get() &#123;</span><br><span class="line">        return names.firstName + &#x27; &#x27; + names.lastName;</span><br><span class="line">      &#125;,</span><br><span class="line">      //真正的修改</span><br><span class="line">      set(newValue) &#123;</span><br><span class="line">        const tempNames = newValue.split(&#x27; &#x27;);</span><br><span class="line">        names.firstName = tempNames[0];</span><br><span class="line">        names.lastName = tempNames[1];</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    const setFullName = () =&gt; &#123;</span><br><span class="line">      //直接修改fullName是不行的 computed返回的是一个只读的ref</span><br><span class="line">      fullName.value = &#x27;天河阔少 aaaaaaaalex&#x27;;</span><br><span class="line">    &#125;;</span><br><span class="line">    return &#123; fullName, setFullName &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="6-setup中获取元素-x2F-组件-实例"><a href="#6-setup中获取元素-x2F-组件-实例" class="headerlink" title="6. setup中获取元素&#x2F;组件 实例"></a>6. <strong>setup中获取元素&#x2F;组件 实例</strong></h2><p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2 ref=&quot;titleRef&quot;&gt;我是标题 哈哈哈&lt;/h2&gt;</span><br><span class="line">    &lt;button ref=&quot;btnRef&quot;&gt;我是按钮 嘿嘿嘿&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;showRes&quot;&gt;点我打印&lt;/button&gt;</span><br><span class="line">    &lt;home ref=&quot;home&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import Home from &#x27;./components/Home.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">  &#125;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const titleRef = ref(null);</span><br><span class="line">    const btnRef = ref(null);</span><br><span class="line">    const home = ref(null);</span><br><span class="line">    const showRes = () =&gt; &#123;</span><br><span class="line">      console.log(titleRef.value);</span><br><span class="line">      console.log(btnRef.value);</span><br><span class="line">      console.log(home.value);</span><br><span class="line">    &#125;;</span><br><span class="line">    return &#123; titleRef, btnRef, showRes, home &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Home.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; title &#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const title = ref(&#x27;我是home&#x27;);</span><br><span class="line">    return &#123; title &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="7-setup中生命周期变化"><a href="#7-setup中生命周期变化" class="headerlink" title="7. setup中生命周期变化"></a>7. <strong>setup中生命周期变化</strong></h2><table>
<thead>
<tr>
<th><strong>选项式API</strong></th>
<th><strong>setup</strong></th>
</tr>
</thead>
<tbody><tr>
<td>beforeCreate</td>
<td>-</td>
</tr>
<tr>
<td>created</td>
<td>-</td>
</tr>
<tr>
<td>beforeMount</td>
<td>onBeforeMount</td>
</tr>
<tr>
<td>mounted</td>
<td>onMounted</td>
</tr>
<tr>
<td>beforeUpdate</td>
<td>onBeforeUpdate</td>
</tr>
<tr>
<td>updated</td>
<td>onUpdated</td>
</tr>
<tr>
<td>beforeUnmount</td>
<td>onBeforeUnmount</td>
</tr>
<tr>
<td>unmounted</td>
<td>onUnmounted</td>
</tr>
<tr>
<td>activated</td>
<td>activated</td>
</tr>
<tr>
<td>deactivated</td>
<td>deactivated</td>
</tr>
</tbody></table>
<p>因为setup是围绕beforeCreate和created运行的，所以不再需要这两个生命周期，换句话说原来在这两个生命周期中执行的操作都直接在setup中书写即可</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; title &#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref, onMounted &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    onMounted(() =&gt; &#123;</span><br><span class="line">      console.log(&#x27;我挂载了&#x27;);</span><br><span class="line">    &#125;);</span><br><span class="line">    const title = ref(&#x27;我是home&#x27;);</span><br><span class="line">    return &#123; title &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="8-Provide-x2F-Inject"><a href="#8-Provide-x2F-Inject" class="headerlink" title="8. Provide&#x2F;Inject"></a>8. <strong>Provide&#x2F;Inject</strong></h2><p>provide有两个参数</p>
<p>​	name：提供的属性名称</p>
<p>​	value：提供的属性值</p>
<p>inject有两个参数</p>
<p>​	要inject的属性的名称</p>
<p>​	默认值</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;app的name:&#123;&#123; name &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;change&quot;&gt;修改name&lt;/button&gt;</span><br><span class="line">    &lt;home /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref, provide &#125; from &#x27;vue&#x27;;</span><br><span class="line">import Home from &#x27;./components/Home.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">  &#125;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    let age = 18;</span><br><span class="line">    const name = ref(&#x27;alex&#x27;);</span><br><span class="line">    provide(&#x27;name&#x27;, name);</span><br><span class="line">    provide(&#x27;age&#x27;, age);</span><br><span class="line">    const change = () =&gt; &#123;</span><br><span class="line">      name.value = &#x27;天河阔少&#x27;;</span><br><span class="line">      age = 19;</span><br><span class="line">    &#125;;</span><br><span class="line">    return &#123;</span><br><span class="line">      name,</span><br><span class="line">      change,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Home.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;home的name:&#123;&#123; name &#125;&#125;--&#123;&#123; age &#125;&#125;--&#123;&#123; height &#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; inject &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const name = inject(&#x27;name&#x27;);</span><br><span class="line">    const age = inject(&#x27;age&#x27;);</span><br><span class="line">    //设置默认值</span><br><span class="line">    const height = inject(&#x27;height&#x27;, 1.88);</span><br><span class="line">    return &#123; name, age, height &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="9-setup中的侦听器"><a href="#9-setup中的侦听器" class="headerlink" title="9. setup中的侦听器"></a>9. <strong>setup中的侦听器</strong></h2><p>watch:手动指定侦听的数据源</p>
<p>watchEffect:自动的收集响应式的数据依赖</p>
<h3 id="9-1-watch"><a href="#9-1-watch" class="headerlink" title="9.1 watch"></a><strong>9.1 watch</strong></h3><p>基础使用</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; msg &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;msg = &#x27;天河阔少&#x27;&quot;&gt;修改msg&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref, watch &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const msg = ref(&#x27;hello world&#x27;);</span><br><span class="line">    //侦听数据msg的变化</span><br><span class="line">    watch(msg, (newValue, oldValue) =&gt; &#123;</span><br><span class="line">      console.log(newValue, oldValue);</span><br><span class="line">    &#125;);</span><br><span class="line">    return &#123;</span><br><span class="line">      msg,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>侦听复杂对象</p>
<p>ref定义的需要深层监听，reactive定义的不需要</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; info &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;editInfo&quot;&gt;修改info&lt;/button&gt;</span><br><span class="line">    &lt;hr /&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; obj &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;editObj&quot;&gt;修改obj&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref, watch, reactive &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const info = ref(&#123;</span><br><span class="line">      name: &#x27;alex&#x27;,</span><br><span class="line">      age: 18,</span><br><span class="line">      friend: &#123;</span><br><span class="line">        name: &#x27;jack&#x27;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    const editInfo = () =&gt; &#123;</span><br><span class="line">      info.value.friend.name = &#x27;666&#x27;;</span><br><span class="line">    &#125;;</span><br><span class="line">    watch(</span><br><span class="line">      info,</span><br><span class="line">      () =&gt; &#123;</span><br><span class="line">        console.log(&#x27;监听的数据变化了～～～&#x27;);</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        deep: true,</span><br><span class="line">        // immediate:true</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">    const obj = reactive(&#123;</span><br><span class="line">      name: &#x27;alex&#x27;,</span><br><span class="line">      age: 18,</span><br><span class="line">      friend: &#123;</span><br><span class="line">        name: &#x27;jack&#x27;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    const editObj = () =&gt; &#123;</span><br><span class="line">      obj.friend.name = &#x27;666&#x27;;</span><br><span class="line">    &#125;;</span><br><span class="line">    watch(</span><br><span class="line">      obj,</span><br><span class="line">      () =&gt; &#123;</span><br><span class="line">        console.log(&#x27;obj变化了我要做一些事&#x27;);</span><br><span class="line">      &#125;</span><br><span class="line">      // &#123;</span><br><span class="line">      //   deep: true,</span><br><span class="line">      // &#125;</span><br><span class="line">    );</span><br><span class="line">    return &#123;</span><br><span class="line">      info,</span><br><span class="line">      editInfo,</span><br><span class="line">      obj,</span><br><span class="line">      editObj,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="9-2-watchEffect"><a href="#9-2-watchEffect" class="headerlink" title="9.2 watchEffect"></a><strong>9.2 watchEffect</strong></h3><p>不仅能够自动监听响应式的依赖变化，而且能够在你需要的时候停止监听</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; count &#125;&#125;--&#123;&#123; name &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;count++&quot;&gt;++&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;name += &#x27;hahaha&#x27;&quot;&gt;修改name&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref, watch, watchEffect &#125; from &#x27;vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const count = ref(0);</span><br><span class="line">    const name = ref(&#x27;alex&#x27;);</span><br><span class="line">    //使用watch监听</span><br><span class="line">    // watch(count,()=&gt;&#123;&#125;,&#123;&#125;)</span><br><span class="line">    //使用watchEffect监听</span><br><span class="line">    //watchEffect的回调，默认会直接执行一次</span><br><span class="line">    //执行的过程中会自动收集依赖(那些响应式数据变化)</span><br><span class="line">    const stopWatch = watchEffect(() =&gt; &#123;</span><br><span class="line">      console.log(&#x27;变化了～～～～&#x27;, count.value, name.value);</span><br><span class="line">      //满足某些条件时不再监听</span><br><span class="line">      if (count.value &gt;= 10) &#123;</span><br><span class="line">        stopWatch();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      count,</span><br><span class="line">      name,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="10-setupHooks练习"><a href="#10-setupHooks练习" class="headerlink" title="10. setupHooks练习"></a>10. <strong>setupHooks练习</strong></h2><p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;app&quot;&gt;</span><br><span class="line">    &lt;h2&gt;当前计数:&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;add&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;sub&quot;&gt;-1&lt;/button&gt;</span><br><span class="line">    &lt;hr /&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; title &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;sortClick&quot;&gt;首页-排行榜&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;hotClick&quot;&gt;首页-歌单推荐&lt;/button&gt;</span><br><span class="line">    &lt;div class=&quot;scroll&quot;&gt;</span><br><span class="line">      &lt;h2&gt;x:&#123;&#123; scrollPosition.x &#125;&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;h2&gt;y:&#123;&#123; scrollPosition.y &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import useCount from &#x27;./hooks/useCount&#x27;;</span><br><span class="line">import useTitle from &#x27;./hooks/useTitle&#x27;;</span><br><span class="line">import useScrollPosition from &#x27;./hooks/useScrollPosition&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    //计数器的逻辑</span><br><span class="line">    const &#123; count, add, sub &#125; = useCount();</span><br><span class="line">    //title的逻辑</span><br><span class="line">    const &#123; title &#125; = useTitle(&#x27;首页&#x27;);</span><br><span class="line">    const sortClick = () =&gt; &#123;</span><br><span class="line">      title.value = &#x27;排行榜&#x27;;</span><br><span class="line">    &#125;;</span><br><span class="line">    const hotClick = () =&gt; &#123;</span><br><span class="line">      title.value = &#x27;热门歌单&#x27;;</span><br><span class="line">    &#125;;</span><br><span class="line">    //滚动条的逻辑</span><br><span class="line">    const &#123; scrollPosition &#125; = useScrollPosition();</span><br><span class="line">    // console.log(scrollPosition);</span><br><span class="line">    return &#123;</span><br><span class="line">      count,</span><br><span class="line">      add,</span><br><span class="line">      sub,</span><br><span class="line">      title,</span><br><span class="line">      sortClick,</span><br><span class="line">      hotClick,</span><br><span class="line">      scrollPosition,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    // //如果只有一个hooks而且逻辑比较简单</span><br><span class="line">    // return &#123;</span><br><span class="line">    //   ...useCount(),</span><br><span class="line">    // &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.app &#123;</span><br><span class="line">  width: 800px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="10-1-useCount练习"><a href="#10-1-useCount练习" class="headerlink" title="10.1 useCount练习"></a><strong>10.1 useCount练习</strong></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//实现计数器逻辑</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useCount</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">add</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    count.<span class="property">value</span>++;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">sub</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    count.<span class="property">value</span>--;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    count,</span><br><span class="line">    add,</span><br><span class="line">    sub,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="10-2-useTitle练习"><a href="#10-2-useTitle练习" class="headerlink" title="10.2 useTitle练习"></a><strong>10.2 useTitle练习</strong></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, watchEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useTitle</span>(<span class="params">titleValue = <span class="string">&#x27;首页&#x27;</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> title = <span class="title function_">ref</span>(titleValue);</span><br><span class="line">  <span class="comment">//监听title的变化并且设置title</span></span><br><span class="line">  <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">title</span> = title.<span class="property">value</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    title,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="10-3-useScrollPosition练习"><a href="#10-3-useScrollPosition练习" class="headerlink" title="10.3 useScrollPosition练习"></a><strong>10.3 useScrollPosition练习</strong></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useScrollPosition</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">//用reactive记录位置</span></span><br><span class="line">  <span class="keyword">const</span> scrollPosition = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">    <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//监听页面滚动</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    scrollPosition.<span class="property">x</span> = <span class="variable language_">window</span>.<span class="property">scrollX</span>;</span><br><span class="line">    scrollPosition.<span class="property">y</span> = <span class="variable language_">window</span>.<span class="property">scrollY</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    scrollPosition,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="11-语法糖"><a href="#11-语法糖" class="headerlink" title="11. 语法糖"></a>11. <strong><script setup>语法糖</strong></h2><p><strong>基础用法</strong></p>
<p>是SFC中使用组合式api编译时的语法糖。当同时使用sfc与组合式api时推荐该写法</p>
<p>使用这个语法 只需要在script标签上加一个setup，里面的所有代码会被自动编译成setup函数内的代码</p>
<p><strong>顶层的绑定会被暴露给模版</strong></p>
<p>任何在 setup> 中声明的顶层的绑定（变量，函数声明，以及import的内容）都能直接在模版中使用，导入的组件都不需要再注册</p>
<p><strong>父子组件通信defineProps()和defineEmits()</strong></p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;add&quot;&gt;+&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;sub&quot;&gt;-&lt;/button&gt;</span><br><span class="line">    &lt;home :count=&quot;count&quot; @changeCount=&quot;changeCount&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import Home from &#x27;./components/Home.vue&#x27;;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">const count = ref(0);</span><br><span class="line">const add = () =&gt; &#123;</span><br><span class="line">  count.value++;</span><br><span class="line">&#125;;</span><br><span class="line">const sub = () =&gt; &#123;</span><br><span class="line">  count.value--;</span><br><span class="line">&#125;;</span><br><span class="line">const changeCount = (payload) =&gt; &#123;</span><br><span class="line">  count.value = payload;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>ShowInfo.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;home&quot;&gt;</span><br><span class="line">    &lt;h2&gt;hahahahah&lt;/h2&gt;</span><br><span class="line">    &#123;&#123; count &#125;&#125;</span><br><span class="line">    &lt;button @click=&quot;changeCount&quot;&gt;changeCount&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">const props = defineProps(&#123;</span><br><span class="line">  count: &#123;</span><br><span class="line">    type: Number,</span><br><span class="line">    default: 0,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">//自定义事件</span><br><span class="line">const emits = defineEmits([&#x27;changeCount&#x27;]);</span><br><span class="line">const changeCount = () =&gt; &#123;</span><br><span class="line">  emits(&#x27;changeCount&#x27;, 100);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.home &#123;</span><br><span class="line">  background-color: aqua;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>作业：全选反选，有能力的写购物车，抽成hooks</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    id: &#x27;001&#x27;,</span><br><span class="line">    hobby: &#x27;篮球&#x27;,</span><br><span class="line">    check: false,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: &#x27;002&#x27;,</span><br><span class="line">    hobby: &#x27;棒球&#x27;,</span><br><span class="line">    check: false,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: &#x27;003&#x27;,</span><br><span class="line">    hobby: &#x27;羽毛球&#x27;,</span><br><span class="line">    check: false,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    id: &#x27;004&#x27;,</span><br><span class="line">    hobby: &#x27;乒乓球&#x27;,</span><br><span class="line">    check: false,</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>





<p>vuex->pinia->vueRouter->axios->其他特性补充</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://muleandhorse.icu/2022/06/24/b43%20VUE%E7%BB%84%E4%BB%B6%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="RickyD">
      <meta itemprop="description" content="如果站长加班加似了，这个网站就是他留给世界最后的遗产">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mule and Horse">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/24/b43%20VUE%E7%BB%84%E4%BB%B6%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85/" class="post-title-link" itemprop="url">vue的组件化的其他知识</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-24 16:06:09" itemprop="dateCreated datePublished" datetime="2022-06-24T16:06:09+08:00">2022-06-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-07-22 21:11:17" itemprop="dateModified" datetime="2023-07-22T21:11:17+08:00">2023-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>9 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="组件其他知识"><a href="#组件其他知识" class="headerlink" title="组件其他知识"></a>组件其他知识</h1><h2 id="1-组件的生命周期"><a href="#1-组件的生命周期" class="headerlink" title="1. 组件的生命周期**"></a>1. 组件的生命周期**</h2><h3 id="1-1-认识生命周期"><a href="#1-1-认识生命周期" class="headerlink" title="1.1 认识生命周期"></a><strong>1.1 认识生命周期</strong></h3><p>生命周期：每个组件都可能会经历<strong>创建，挂载，更新，卸载</strong>等一系列的过程，在这些过程的某个阶段我们可能想要添加一些属于自己的代码逻辑，比如组件创建完成后请求服务器数据，比如挂载完成后监听事件总线。都要用到生命周期函数才行。</p>
<p>生命周期函数：是一些钩子函数，在特定的时间会被Vue源码内部自动调用，通过生命周期函数我们可以知道目前组件处于什么阶段，那么就可以在对应的阶段编写自己的代码。</p>
<h3 id="1-2-生命周期的流程"><a href="#1-2-生命周期的流程" class="headerlink" title="1.2 生命周期的流程"></a><strong>1.2 生命周期的流程</strong></h3><p><img src="https://cn.vuejs.org/assets/lifecycle.16e4c08e.png" alt="组件生命周期图示"></p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;count++&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">    &lt;home v-if=&quot;isShow&quot; /&gt;</span><br><span class="line">    &lt;button @click=&quot;isShow = !isShow&quot;&gt;显示/隐藏home&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Home from &#x27;./components/Home.vue&#x27;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      count: 0,</span><br><span class="line">      isShow: true,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">  &#125;,</span><br><span class="line">  //1.组件创建前</span><br><span class="line">  beforeCreate() &#123;</span><br><span class="line">    console.log(&#x27;beforeCreated&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  //2.组件创建完毕</span><br><span class="line">  created() &#123;</span><br><span class="line">    console.log(&#x27;created---&#x27;);</span><br><span class="line">    console.log(&#x27;发送网络请求，监听watch数据，监听bus&#x27;);</span><br><span class="line">    console.log(&#x27;created---&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  //3.组件的template准备好了</span><br><span class="line">  beforeMount() &#123;</span><br><span class="line">    console.log(&#x27;beforeMount&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  //4. 组件挂载 虚拟DOM-&gt;真实DOM</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    console.log(&#x27;mounted&#x27;);</span><br><span class="line">    console.log(&#x27;获取DOM,操作DOM&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  //5.数据发生改变 准备更新</span><br><span class="line">  beforeUpdate() &#123;</span><br><span class="line">    console.log(&#x27;beforeUpdate&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  //6. 更新</span><br><span class="line">  updated() &#123;</span><br><span class="line">    console.log(&#x27;updated&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>Home.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;count++&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">    &lt;home v-if=&quot;isShow&quot; /&gt;</span><br><span class="line">    &lt;button @click=&quot;isShow = !isShow&quot;&gt;显示/隐藏home&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Home from &#x27;./components/Home.vue&#x27;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      count: 0,</span><br><span class="line">      isShow: true,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">  &#125;,</span><br><span class="line">  //1.组件创建前</span><br><span class="line">  beforeCreate() &#123;</span><br><span class="line">    console.log(&#x27;beforeCreated&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  //2.组件创建完毕</span><br><span class="line">  created() &#123;</span><br><span class="line">    console.log(&#x27;created---&#x27;);</span><br><span class="line">    console.log(&#x27;发送网络请求，监听watch数据，监听bus&#x27;);</span><br><span class="line">    console.log(&#x27;created---&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  //3.组件的template准备好了</span><br><span class="line">  beforeMount() &#123;</span><br><span class="line">    console.log(&#x27;beforeMount&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  //4. 组件挂载 虚拟DOM-&gt;真实DOM</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    console.log(&#x27;mounted&#x27;);</span><br><span class="line">    console.log(&#x27;获取DOM,操作DOM&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  //5.数据发生改变 准备更新</span><br><span class="line">  beforeUpdate() &#123;</span><br><span class="line">    console.log(&#x27;beforeUpdate&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  //6. 更新</span><br><span class="line">  updated() &#123;</span><br><span class="line">    console.log(&#x27;updated&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="2-ref-parent-root"><a href="#2-ref-parent-root" class="headerlink" title="2. $ref,$parent,$root"></a>2. $ref,$parent,$root</h2><p> 注意vue3中没有了$children</p>
<p> ref获取真实Dom&#x2F;组件实例用的</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2 ref=&quot;title&quot; class=&quot;title&quot; :style=&quot;&#123; color: titleColor &#125;&quot;&gt;&#123;&#123; msg &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button ref=&quot;btn&quot; @click=&quot;editTitle&quot;&gt;修改title&lt;/button&gt;</span><br><span class="line">    &lt;home ref=&quot;home&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Home from &#x27;./components/Home.vue&#x27;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      msg: &#x27;hello 小肥君&#x27;,</span><br><span class="line">      titleColor: &#x27;black&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    editTitle() &#123;</span><br><span class="line">      //1. 不要主动获取dom，修改dom</span><br><span class="line">      //而是用vue提供的一些语法来操作模版</span><br><span class="line">      // this.msg = &#x27;天河阔少～～～&#x27;;</span><br><span class="line">      // this.titleColor = &#x27;red&#x27;;</span><br><span class="line">      //2. 某些情况下不得不获取dom就得给你想获取的元素加上ref=&quot;名称&quot;</span><br><span class="line">      // console.log(this.$refs.title, this.$refs.btn);</span><br><span class="line">      // console.log(this.$refs.home);</span><br><span class="line">      //3.获取到组件的实例之后我们还能做一些事</span><br><span class="line">      // console.log(this.$refs.home.$el);</span><br><span class="line">      //4.$parent $root</span><br><span class="line">      //this当前的组件实例app</span><br><span class="line">      //获取当前实例的父组件</span><br><span class="line">      console.log(this.$parent);</span><br><span class="line">      //获取根组件</span><br><span class="line">      console.log(this.$root);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>Home.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;Home&lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      msg: &#x27;66666&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    console.log(&#x27;home:&#x27;, this.$parent);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="3-动态组件"><a href="#3-动态组件" class="headerlink" title="3. 动态组件"></a>3. 动态组件</h2><h3 id="3-1-v-if显示不同组件"><a href="#3-1-v-if显示不同组件" class="headerlink" title="3.1 v-if显示不同组件"></a><strong>3.1 v-if显示不同组件</strong></h3><p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div class=&quot;btns&quot;&gt;</span><br><span class="line">      &lt;template v-for=&quot;(item, index) in tabs&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          :class=&quot;&#123; active: currentIndex === index &#125;&quot;</span><br><span class="line">          @click=&quot;itemClick(index)&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &#123;&#123; item &#125;&#125;</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;views&quot;&gt;</span><br><span class="line">      &lt;!-- v-if来决定显示那个组件 --&gt;</span><br><span class="line">      &lt;template v-if=&quot;currentIndex === 0&quot;&gt;</span><br><span class="line">        &lt;home /&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;template v-else-if=&quot;currentIndex === 1&quot;&gt;</span><br><span class="line">        &lt;about /&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;template v-else-if=&quot;currentIndex === 2&quot;&gt;</span><br><span class="line">        &lt;categroy /&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Home from &#x27;./views/Home.vue&#x27;;</span><br><span class="line">import About from &#x27;./views/About.vue&#x27;;</span><br><span class="line">import Categroy from &#x27;./views/Categroy.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      tabs: [&#x27;home&#x27;, &#x27;about&#x27;, &#x27;categroy&#x27;],</span><br><span class="line">      currentIndex: 0,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    itemClick(idx) &#123;</span><br><span class="line">      this.currentIndex = idx;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">    About,</span><br><span class="line">    Categroy,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.active &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="3-2-动态组件"><a href="#3-2-动态组件" class="headerlink" title="3.2 动态组件"></a><strong>3.2 动态组件</strong></h3><p>动态组件就是使用 component组件，通过一个特殊的属性 <strong>is</strong> 来实现。</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div class=&quot;btns&quot;&gt;</span><br><span class="line">      &lt;template v-for=&quot;item in tabs&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          :class=&quot;&#123; active: currentTab === item &#125;&quot;</span><br><span class="line">          @click=&quot;itemClick(item)&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &#123;&#123; item &#125;&#125;</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;views&quot;&gt;</span><br><span class="line">      &lt;!-- 做法二：动态组件 --&gt;</span><br><span class="line">      &lt;!-- is接收的内容来自于两个地方，1.全局注册的组件 2.局部注册的组件 --&gt;</span><br><span class="line">      &lt;!--你的is要的就是 home about categroy 中的某一个--&gt;</span><br><span class="line">      &lt;!-- &lt;component :is=&quot;tabs[currentIndex]&quot;&gt; &lt;/component&gt; --&gt;</span><br><span class="line">      &lt;!-- &lt;component :is=&quot;currentTab&quot;&gt; &lt;/component&gt; --&gt;</span><br><span class="line">      &lt;component :is=&quot;currentTab&quot; /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Home from &#x27;./views/Home.vue&#x27;;</span><br><span class="line">import About from &#x27;./views/About.vue&#x27;;</span><br><span class="line">import Categroy from &#x27;./views/Categroy.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      tabs: [&#x27;home&#x27;, &#x27;about&#x27;, &#x27;categroy&#x27;],</span><br><span class="line">      // currentIndex: 0,</span><br><span class="line">      //决定当前显示哪一个组件</span><br><span class="line">      currentTab: &#x27;home&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    itemClick(tab) &#123;</span><br><span class="line">      this.currentTab = tab;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">    About,</span><br><span class="line">    Categroy,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.active &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>动态组件传递数据和监听事件</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div class=&quot;btns&quot;&gt;</span><br><span class="line">      &lt;template v-for=&quot;item in tabs&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          :class=&quot;&#123; active: currentTab === item &#125;&quot;</span><br><span class="line">          @click=&quot;itemClick(item)&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &#123;&#123; item &#125;&#125;</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;views&quot;&gt;</span><br><span class="line">      &lt;!-- 和其他组件一样，能传数据，能监听事件,只不过传数据的时候相当于是给home about category都传了 --&gt;</span><br><span class="line">      &lt;component</span><br><span class="line">        :is=&quot;currentTab&quot;</span><br><span class="line">        name=&quot;alex&quot;</span><br><span class="line">        :age=&quot;18&quot;</span><br><span class="line">        @homeClick=&quot;homeClick&quot;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Home from &#x27;./views/Home.vue&#x27;;</span><br><span class="line">import About from &#x27;./views/About.vue&#x27;;</span><br><span class="line">import Categroy from &#x27;./views/Categroy.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      tabs: [&#x27;home&#x27;, &#x27;about&#x27;, &#x27;categroy&#x27;],</span><br><span class="line">      // currentIndex: 0,</span><br><span class="line">      //决定当前显示哪一个组件</span><br><span class="line">      currentTab: &#x27;home&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    homeClick(payload) &#123;</span><br><span class="line">      console.log(payload);</span><br><span class="line">    &#125;,</span><br><span class="line">    itemClick(tab) &#123;</span><br><span class="line">      this.currentTab = tab;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">    About,</span><br><span class="line">    Categroy,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.active &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>Home.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;Home&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;homeClick&quot;&gt;点我&lt;/button&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; name &#125;&#125;--&#123;&#123; age &#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: [&#x27;name&#x27;, &#x27;age&#x27;],</span><br><span class="line">  methods: &#123;</span><br><span class="line">    homeClick() &#123;</span><br><span class="line">      this.$emit(&#x27;homeClick&#x27;, &#x27;我是home的参数&#x27;);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="4-keep-alive"><a href="#4-keep-alive" class="headerlink" title="4. keep-alive"></a>4. keep-alive</h2><h3 id="4-1-基本使用"><a href="#4-1-基本使用" class="headerlink" title="4.1 基本使用"></a><strong>4.1 基本使用</strong></h3><p>App.vue中变化的部分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;keep-alive include=&quot;about&quot;&gt;</span><br><span class="line">      &lt;component :is=&quot;currentTab&quot; /&gt;</span><br><span class="line">    &lt;/keep-alive&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>About.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;About&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;当前的计数：&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;count++&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      count: 0,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>当我们点击about的按钮然后再切换的时候，整个about组件的状态不会保留，使用keep-alive会保留组件的状态，可以满足某些场景的需求，也能从一定程度上避免恶劣用户短时间大量操作dom。</p>
<p>keep-alive中填的是在options中填写的name</p>
<p>keep-alive：</p>
<p>​	默认缓存所有组件</p>
<p>​	include 缓存匹配的组件</p>
<p>​	exclude 不缓存匹配的组件</p>
<p>​	max 设置最大缓存组件数量，一旦达到这个数量，那么缓存的组件中最尽没有被访问过的就不再缓存</p>
<h3 id="4-2-缓存组件的生命周期"><a href="#4-2-缓存组件的生命周期" class="headerlink" title="4.2 缓存组件的生命周期"></a><strong>4.2 缓存组件的生命周期</strong></h3><p>对于缓存的组件，再次进入的时候，created和mounted不会再次触发，但是有时候我们又得知道何时进入了缓存的组件，何时从缓存的组件中离开了</p>
<p>activated 进入</p>
<p>deactivated 离开</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div class=&quot;btns&quot;&gt;</span><br><span class="line">      &lt;template v-for=&quot;item in tabs&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          :class=&quot;&#123; active: currentTab === item &#125;&quot;</span><br><span class="line">          @click=&quot;itemClick(item)&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &#123;&#123; item &#125;&#125;</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;views&quot;&gt;</span><br><span class="line">      &lt;!-- 缓存组件 --&gt;</span><br><span class="line">      &lt;keep-alive include=&quot;about&quot;&gt;</span><br><span class="line">        &lt;component :is=&quot;currentTab&quot; /&gt;</span><br><span class="line">      &lt;/keep-alive&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Home from &#x27;./views/Home.vue&#x27;;</span><br><span class="line">import About from &#x27;./views/About.vue&#x27;;</span><br><span class="line">import Categroy from &#x27;./views/Categroy.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      tabs: [&#x27;home&#x27;, &#x27;about&#x27;, &#x27;categroy&#x27;],</span><br><span class="line">      // currentIndex: 0,</span><br><span class="line">      //决定当前显示哪一个组件</span><br><span class="line">      currentTab: &#x27;home&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    itemClick(tab) &#123;</span><br><span class="line">      this.currentTab = tab;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">    About,</span><br><span class="line">    Categroy,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.active &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>About</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;About&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;当前的计数：&#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;count++&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;about&#x27;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      count: 0,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  activated() &#123;</span><br><span class="line">    console.log(&#x27;进入了about&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  deactivated() &#123;</span><br><span class="line">    console.log(&#x27;离开了about&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    console.log(&#x27;创建完毕&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    console.log(&#x27;挂载完毕&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="5-异步组件"><a href="#5-异步组件" class="headerlink" title="5. 异步组件"></a>5. 异步组件</h2><h3 id="5-1-webpack的代码分包"><a href="#5-1-webpack的代码分包" class="headerlink" title="5.1 webpack的代码分包"></a><strong>5.1 webpack的代码分包</strong></h3><p><img src="https://img-1317399392.cos.ap-guangzhou.myqcloud.com/img/image-20230629195538701.png" alt="image-20230629195538701"></p>
<p>我们的math.js是直接引入的，组件化的过程中是直接通过模块化的依赖打包进<a target="_blank" rel="noopener" href="http://app.xxxxxxx.js/">app.xxxxxxx.js</a></p>
<p><img src="https://img-1317399392.cos.ap-guangzhou.myqcloud.com/img/image-20230629195549942.png" alt="image-20230629195549942"></p>
<p>所以我们对于一些不需要立即展示的组件会拆分为一个个的chunk，这些chunk不会在首屏就下载而是等用户进入到对应的页面再下载对应的js来运行。</p>
<p>main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span>(<span class="string">&#x27;./utils/math&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">&#123; add &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">add</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// import math from &#x27;./utils/math&#x27;;</span></span><br><span class="line"><span class="comment">// webpack分包</span></span><br><span class="line"><span class="comment">// math.add(1, 2);</span></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>);</span><br></pre></td></tr></table></figure>



<h3 id="5-2-Vue实现异步组件"><a href="#5-2-Vue实现异步组件" class="headerlink" title="5.2 Vue实现异步组件"></a><strong>5.2 Vue实现异步组件</strong></h3><p>如果项目过大(路由懒加载)我们希望对于某些组件采用异步加载的形式(目的是为了分包),vue提供的一个函数</p>
<p>defineAsyncComponent:工厂函数 需要返回一个promise对象</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div class=&quot;btns&quot;&gt;</span><br><span class="line">      &lt;template v-for=&quot;item in tabs&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          :class=&quot;&#123; active: currentTab === item &#125;&quot;</span><br><span class="line">          @click=&quot;itemClick(item)&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &#123;&#123; item &#125;&#125;</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;views&quot;&gt;</span><br><span class="line">      &lt;component :is=&quot;currentTab&quot; /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; defineAsyncComponent &#125; from &#x27;vue&#x27;;</span><br><span class="line">import Home from &#x27;./views/Home.vue&#x27;;</span><br><span class="line">// 使用异步组件</span><br><span class="line">// import About from &#x27;./views/About.vue&#x27;;</span><br><span class="line">const asyncAbout = defineAsyncComponent(() =&gt; import(&#x27;./views/About.vue&#x27;));</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">    About: asyncAbout,</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      tabs: [&#x27;home&#x27;, &#x27;about&#x27;],</span><br><span class="line">      // currentIndex: 0,</span><br><span class="line">      //决定当前显示哪一个组件</span><br><span class="line">      currentTab: &#x27;home&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    itemClick(tab) &#123;</span><br><span class="line">      this.currentTab = tab;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.active &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="https://img-1317399392.cos.ap-guangzhou.myqcloud.com/img/image-20230629195634824.png" alt="image-20230629195634824"></p>
<p>异步组件配合<strong>suspense</strong>实现<strong>骨架屏</strong></p>
<h2 id="6-组件的v-model"><a href="#6-组件的v-model" class="headerlink" title="6. 组件的v-model"></a>6. 组件的v-model</h2><h3 id="6-1-v-model在组件上做了什么"><a href="#6-1-v-model在组件上做了什么" class="headerlink" title="6.1 v-model在组件上做了什么"></a><strong>6.1 v-model在组件上做了什么</strong></h3><p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;!-- 1.表单元素的v-model --&gt;</span><br><span class="line">    &lt;!-- 做了两件事 </span><br><span class="line">      1.动态绑定一个值</span><br><span class="line">      :value=&quot;msg&quot;  </span><br><span class="line">      2.监听事件</span><br><span class="line">      @input=&quot;msg=$event.target.value&quot;--&gt;</span><br><span class="line">    &lt;!-- &lt;input type=&quot;text&quot; v-model=&quot;msg&quot; /&gt; --&gt;</span><br><span class="line">    &lt;!-- &lt;h2&gt;&#123;&#123; msg &#125;&#125;&lt;/h2&gt; --&gt;</span><br><span class="line">    &lt;!-- 2.如果在组件上使用v-model也是做了两件事 --&gt;</span><br><span class="line">    &lt;h1&gt;父组件展示&#123;&#123; msg &#125;&#125;&lt;/h1&gt;</span><br><span class="line">    &lt;home v-model=&quot;msg&quot; /&gt;</span><br><span class="line">    &lt;!-- 相当于如下的操作，只不过是属性的名称和事件不一样了--&gt;</span><br><span class="line">    &lt;!-- &lt;home :modelValue=&quot;msg&quot; @update:modelValue=&quot;msg = $event&quot; /&gt; --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Home from &#x27;./views/Home.vue&#x27;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      msg: &#x27;哈哈哈哈&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.active &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Home.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; :value=&quot;modelValue&quot; @input=&quot;inputChange&quot; /&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; modelValue &#125;&#125;&lt;/h3&gt;</span><br><span class="line">    &lt;h2&gt;Home&lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  emits: [&#x27;update:modelValue&#x27;],</span><br><span class="line">  name: &#x27;home&#x27;,</span><br><span class="line">  props: [&#x27;modelValue&#x27;],</span><br><span class="line">  methods: &#123;</span><br><span class="line">    inputChange(event) &#123;</span><br><span class="line">      this.$emit(&#x27;update:modelValue&#x27;, event.target.value);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="6-2-v-model绑定多个属性"><a href="#6-2-v-model绑定多个属性" class="headerlink" title="6.2 v-model绑定多个属性"></a><strong>6.2 v-model绑定多个属性</strong></h3><p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;父组件展示--&#123;&#123; alex &#125;&#125;&lt;/h1&gt;</span><br><span class="line">    &lt;!-- v-model绑定多个属性而且希望有自己的名字 --&gt;</span><br><span class="line">    &lt;home v-model=&quot;msg&quot; v-model:alex=&quot;alex&quot; /&gt;</span><br><span class="line">    &lt;home v-model:alex=&quot;alex&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Home from &#x27;./views/Home.vue&#x27;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    Home,</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      msg: &#x27;哈哈哈哈&#x27;,</span><br><span class="line">      alex: &#x27;天河阔少&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.active &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>Home.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;!-- &lt;input type=&quot;text&quot; :value=&quot;modelValue&quot; @input=&quot;inputChange&quot; /&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; modelValue &#125;&#125;&lt;/h3&gt; --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h2&gt;Home&lt;/h2&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; :value=&quot;alex&quot; @input=&quot;inputChange2&quot; /&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; alex &#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  emits: [&#x27;update:modelValue&#x27;, &#x27;update:alex&#x27;],</span><br><span class="line">  name: &#x27;home&#x27;,</span><br><span class="line">  props: [&#x27;modelValue&#x27;, &#x27;alex&#x27;],</span><br><span class="line">  methods: &#123;</span><br><span class="line">    inputChange(event) &#123;</span><br><span class="line">      this.$emit(&#x27;update:modelValue&#x27;, event.target.value);</span><br><span class="line">    &#125;,</span><br><span class="line">    inputChange2(event) &#123;</span><br><span class="line">      this.$emit(&#x27;update:alex&#x27;, event.target.value);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="7-混入Mixin"><a href="#7-混入Mixin" class="headerlink" title="7. 混入Mixin"></a>7. 混入Mixin</h2><p>组件之间难免会有相同的代码逻辑，这个时候我们希望对相同的代码逻辑进行抽取。</p>
<p>my-mixin.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">msg</span>: <span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">123</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>Home.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;Home&lt;/h2&gt;</span><br><span class="line">    &#123;&#123; msg &#125;&#125;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import myMixin from &#x27;@/mixin/my-mixin.js&#x27;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;home&#x27;,</span><br><span class="line">  //是mixins而不是mixin</span><br><span class="line">  mixins: [myMixin],</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>全局混入，修改main.js</p>
<p>main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> myMixin <span class="keyword">from</span> <span class="string">&#x27;./mixin/my-mixin&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>);</span><br><span class="line"><span class="comment">//全局混入</span></span><br><span class="line">app.<span class="title function_">mixin</span>(myMixin);</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>mixin的合并规则</p>
<ol>
<li>data的冲突</li>
</ol>
<p>以组件自身为主</p>
<ol start="2">
<li>生命周期的冲突</li>
</ol>
<p>mixin和组件自身的都会调用，而且mixin先调用。</p>
<p><img src="https://img-1317399392.cos.ap-guangzhou.myqcloud.com/img/image-20230629200232264.png" alt="image-20230629200232264"></p>
<p>因为在模版中先使用的是home所以home在上面</p>
<ol start="3">
<li>methods的冲突</li>
</ol>
<p>以组件自身为准</p>
<p>实例代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">msg</span>: <span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我是混入&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">123</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Home.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;Home&lt;/h2&gt;</span><br><span class="line">    &#123;&#123; msg &#125;&#125;</span><br><span class="line">    &lt;button @click=&quot;sayHello&quot;&gt;点我&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;home&#x27;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      msg: &#x27;home的msg&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    console.log(&#x27;我是自身的&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    sayHello() &#123;</span><br><span class="line">      console.log(456);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://muleandhorse.icu/2022/06/21/b42%20VUE%E7%BB%84%E4%BB%B6%E5%8C%96%E9%80%9A%E4%BF%A1(%E4%BA%8C)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="RickyD">
      <meta itemprop="description" content="如果站长加班加似了，这个网站就是他留给世界最后的遗产">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mule and Horse">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/21/b42%20VUE%E7%BB%84%E4%BB%B6%E5%8C%96%E9%80%9A%E4%BF%A1(%E4%BA%8C)/" class="post-title-link" itemprop="url">vue的组件化通信(二)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-21 16:06:09" itemprop="dateCreated datePublished" datetime="2022-06-21T16:06:09+08:00">2022-06-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-07-22 21:11:12" itemprop="dateModified" datetime="2023-07-22T21:11:12+08:00">2023-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="6-28-slot和非父子组件通信"><a href="#6-28-slot和非父子组件通信" class="headerlink" title="6-28 slot和非父子组件通信"></a>6-28 slot和非父子组件通信</h1><h2 id="1-插槽的基本使用"><a href="#1-插槽的基本使用" class="headerlink" title="1. 插槽的基本使用"></a>1. 插槽的基本使用</h2><h3 id="1-1-认识插槽"><a href="#1-1-认识插槽" class="headerlink" title="1.1 认识插槽"></a><strong>1.1 认识插槽</strong></h3><p>让使用者可以决定某一块区域到底存放什么内容和元素</p>
<h3 id="1-2-如何使用插槽slot"><a href="#1-2-如何使用插槽slot" class="headerlink" title="1.2 如何使用插槽slot"></a><strong>1.2 如何使用插槽slot</strong></h3><p> 如果需要让组件更加的灵活，可以展示不同的内容和元素就得使用插槽，使用插槽的核心是<strong>抽取共性，预留不同</strong>，我们会将共同的元素，内容依然在组件内封装，将不同的结构使用slot占位，让外部决定到底显示什么</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;!-- 组件在使用的时候是可以写成单标签的 </span><br><span class="line">    但是一旦使用了插槽就得写成双标签--&gt;</span><br><span class="line">    &lt;show-message title=&quot;123&quot;&gt;</span><br><span class="line">      &lt;h1&gt;我是插入的h1&lt;/h1&gt;</span><br><span class="line">    &lt;/show-message&gt;</span><br><span class="line">    &lt;show-message title=&quot;图片&quot;&gt;</span><br><span class="line">      &lt;img src=&quot;./assets/logo.png&quot; alt=&quot;&quot; /&gt;</span><br><span class="line">    &lt;/show-message&gt;</span><br><span class="line">    &lt;show-message title=&quot;按钮&quot;&gt;</span><br><span class="line">      &lt;button&gt;按钮&lt;/button&gt;</span><br><span class="line">    &lt;/show-message&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import ShowMessage from &#x27;./components/ShowMessage.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    ShowMessage,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ShowMessage.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;msg&quot;&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; title &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;!-- 使用slot占位，在父组件中让使用者决定要放入什么结构和内容 --&gt;</span><br><span class="line">    &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    title: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &#x27;我是默认的标题&#x27;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.msg &#123;</span><br><span class="line">  border: solid;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="1-3-插槽的默认内容"><a href="#1-3-插槽的默认内容" class="headerlink" title="1.3 插槽的默认内容"></a><strong>1.3 插槽的默认内容</strong></h3><p>有些时候我们使用插槽时，没有插入对应的内容，需要显示一个默认的内容。</p>
<p>插槽的默认内容直接写在的内部即可</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;show-message title=&quot;123&quot;&gt; &lt;/show-message&gt;</span><br><span class="line">    &lt;show-message title=&quot;图片&quot;&gt;</span><br><span class="line">      &lt;img src=&quot;./assets/logo.png&quot; alt=&quot;&quot; /&gt;</span><br><span class="line">    &lt;/show-message&gt;</span><br><span class="line">    &lt;show-message title=&quot;按钮&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import ShowMessage from &#x27;./components/ShowMessage.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    ShowMessage,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>ShowMessage.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;msg&quot;&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; title &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;slot&gt;</span><br><span class="line">      &lt;!-- 使用的时候不传递结构，默认展示为p --&gt;</span><br><span class="line">      &lt;p&gt;我是默认的内容&lt;/p&gt;</span><br><span class="line">    &lt;/slot&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    title: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &#x27;我是默认的标题&#x27;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.msg &#123;</span><br><span class="line">  border: solid;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="1-4-多个插槽的时候"><a href="#1-4-多个插槽的时候" class="headerlink" title="1.4 多个插槽的时候"></a><strong>1.4 多个插槽的时候</strong></h3><p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;nav-bar&gt;</span><br><span class="line">      &lt;button&gt;左边返回&lt;/button&gt;</span><br><span class="line">      &lt;p&gt;中间标题&lt;/p&gt;</span><br><span class="line">      &lt;i&gt;右边的icon&lt;/i&gt;</span><br><span class="line">    &lt;/nav-bar&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import NavBar from &#x27;./components/NavBar.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    NavBar,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>NavBar.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;nav-bar&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;left&quot;&gt;</span><br><span class="line">      &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;center&quot;&gt;</span><br><span class="line">      &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;right&quot;&gt;</span><br><span class="line">      &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.nav-bar &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  height: 40px;</span><br><span class="line">  line-height: 40px;</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line">.left &#123;</span><br><span class="line">  width: 80px;</span><br><span class="line">  background-color: aquamarine;</span><br><span class="line">&#125;</span><br><span class="line">.center &#123;</span><br><span class="line">  flex: 1;</span><br><span class="line">  background-color: skyblue;</span><br><span class="line">&#125;</span><br><span class="line">.right &#123;</span><br><span class="line">  width: 80px;</span><br><span class="line">  background-color: aqua;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>多个插槽时，默认把我们传递的结构当作一个整体，在每个插槽使用。</p>
<h2 id="2-具名插槽"><a href="#2-具名插槽" class="headerlink" title="2. 具名插槽"></a>2. 具名插槽</h2><h3 id="2-1-具名插槽的基本使用"><a href="#2-1-具名插槽的基本使用" class="headerlink" title="2.1 具名插槽的基本使用"></a><strong>2.1 具名插槽的基本使用</strong></h3><p>给插槽起个名字，使用slot元素的特殊的attribute，<strong>name</strong></p>
<p>不写name的slot默认会有一个default （默认插槽）</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;nav-bar&gt;</span><br><span class="line">      &lt;!-- 指定结构插入到那个插槽 v-slot:name --&gt;</span><br><span class="line">      &lt;template v-slot:center&gt;</span><br><span class="line">        &lt;p&gt;中间标题&lt;/p&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;template v-slot:right&gt;</span><br><span class="line">        &lt;i&gt;右边的icon&lt;/i&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;template v-slot:left&gt;</span><br><span class="line">        &lt;button&gt;左边返回&lt;/button&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/nav-bar&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import NavBar from &#x27;./components/NavBar.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    NavBar,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 0;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>NavBar.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;nav-bar&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;left&quot;&gt;</span><br><span class="line">      &lt;!-- 给插槽起个名字，使用的时候方便插入我想要的结构到具体的某一个插槽 --&gt;</span><br><span class="line">      &lt;slot name=&quot;left&quot;&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;center&quot;&gt;</span><br><span class="line">      &lt;slot name=&quot;center&quot;&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;right&quot;&gt;</span><br><span class="line">      &lt;slot name=&quot;right&quot;&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 0;</span><br><span class="line">&#125;</span><br><span class="line">.nav-bar &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  height: 40px;</span><br><span class="line">  line-height: 40px;</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line">.left &#123;</span><br><span class="line">  width: 80px;</span><br><span class="line">  background-color: aquamarine;</span><br><span class="line">&#125;</span><br><span class="line">.center &#123;</span><br><span class="line">  flex: 1;</span><br><span class="line">  background-color: skyblue;</span><br><span class="line">&#125;</span><br><span class="line">.right &#123;</span><br><span class="line">  width: 80px;</span><br><span class="line">  background-color: aqua;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="2-2-动态插槽名"><a href="#2-2-动态插槽名" class="headerlink" title="2.2 动态插槽名"></a><strong>2.2 动态插槽名</strong></h3><p>2.1中我们写的插槽的名字都是固定死的，可以通过**v-slot:[ dynamicSlotName]**来动态绑定名称</p>
<p>App.vue</p>
<p><img src="https://img-1317399392.cos.ap-guangzhou.myqcloud.com/img/image-20230630121730140.png" alt="image-20230630121730140"></p>
<h3 id="2-3-具名插槽使用的缩写"><a href="#2-3-具名插槽使用的缩写" class="headerlink" title="2.3 具名插槽使用的缩写"></a><strong>2.3 具名插槽使用的缩写</strong></h3><p>v-on缩写@,v-bind缩写:,v-slot:缩写#</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;nav-bar&gt;</span><br><span class="line">      &lt;template v-slot:[position]&gt;</span><br><span class="line">        &lt;button&gt;左边返回&lt;/button&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;!-- 具名插槽的缩写 --&gt;</span><br><span class="line">      &lt;template #center&gt;</span><br><span class="line">        &lt;p&gt;中间标题&lt;/p&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;template v-slot:right&gt;</span><br><span class="line">        &lt;i&gt;右边的icon&lt;/i&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/nav-bar&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import NavBar from &#x27;./components/NavBar.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      position: &#x27;left&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    NavBar,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 0;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="3-作用域插槽"><a href="#3-作用域插槽" class="headerlink" title="3. 作用域插槽"></a>3. 作用域插槽</h2><h3 id="3-1-渲染作用域"><a href="#3-1-渲染作用域" class="headerlink" title="3.1 渲染作用域"></a><strong>3.1 渲染作用域</strong></h3><p>父级模版里面的所有内容都是在父级作用域中编译的</p>
<p>子模版里面的所有内容都是在子级作用域中编译的</p>
<p>案例：在NavBar中可以访问自己作用域的title，但是在App中的h2无法访问，因为他是跨作用域的</p>
<p><img src="https://img-1317399392.cos.ap-guangzhou.myqcloud.com/img/image-20230630121837053.png" alt="image-20230630121837053"></p>
<p>但是，我们往往又希望插槽可以访问到子组件中的内容，这个时候就得用到作用域插槽</p>
<h3 id="3-2-作用域插槽"><a href="#3-2-作用域插槽" class="headerlink" title="3.2 作用域插槽"></a><strong>3.2 作用域插槽</strong></h3><p>作用域插槽就是为了解决3.1的问题，让插槽可以访问子组件中的内容</p>
<ol>
<li><p>在App.vue中定义好数据</p>
</li>
<li><p>传递给子组件</p>
</li>
<li><p>在子组件中使用数据</p>
</li>
<li><p>定义插槽的props</p>
</li>
<li><p>通过v-slot:default的方式获取到插槽的props</p>
</li>
<li><p>使用插槽的props拿到子组件中的内容</p>
</li>
</ol>
<p><img src="https://img-1317399392.cos.ap-guangzhou.myqcloud.com/img/image-20230630121910467.png" alt="image-20230630121910467"></p>
<p>插槽能够访问到子组件中的内容，本质是把slot当作一个组件传递<strong>props</strong></p>
<h3 id="3-3-独占默认插槽的缩写"><a href="#3-3-独占默认插槽的缩写" class="headerlink" title="3.3 独占默认插槽的缩写"></a><strong>3.3 独占默认插槽的缩写</strong></h3><p>如果我们的插槽是默认插槽default，那么<strong>v-slot:default&#x3D;”xxxxx”<strong>可以简写为</strong>v-slot&#x3D;”xxxxx”</strong></p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;nav-bar&gt;</span><br><span class="line">      &lt;!-- 解构不要忘记 --&gt;</span><br><span class="line">      &lt;!-- &lt;template v-slot:default=&quot;&#123; title &#125;&quot;&gt;</span><br><span class="line">        &lt;h2&gt;&#123;&#123; title &#125;&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;/template&gt; --&gt;</span><br><span class="line">      &lt;!-- 独占默认插槽可以简写 --&gt;</span><br><span class="line">      &lt;template v-slot=&quot;&#123; title &#125;&quot;&gt;</span><br><span class="line">        &lt;h2&gt;&#123;&#123; title &#125;&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/nav-bar&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import NavBar from &#x27;./components/NavBar.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    NavBar,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 0;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>NavBar.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;slot :title=&quot;title&quot;&gt; &lt;/slot&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      title: &#x27;哈哈哈哈&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>而且，如果我们的插槽只有默认插槽，组件标签可以直接当作插槽的模版（template）来使用</p>
<p>意思就是你的v-slot可以直接写在组件标签上</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;nav-bar v-slot=&quot;&#123; title &#125;&quot;&gt;</span><br><span class="line">      &lt;h2&gt;&#123;&#123; title &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;/nav-bar&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import NavBar from &#x27;./components/NavBar.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    NavBar,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 0;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>NavBar.vue没变化</p>
<h3 id="3-4-默认插槽和具名插槽混用"><a href="#3-4-默认插槽和具名插槽混用" class="headerlink" title="3.4 默认插槽和具名插槽混用"></a><strong>3.4 默认插槽和具名插槽混用</strong></h3><p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;nav-bar&gt;</span><br><span class="line">      &lt;!-- 只要有多个插槽，始终写成template形式 --&gt;</span><br><span class="line">      &lt;template v-slot=&quot;&#123; title &#125;&quot;&gt;</span><br><span class="line">        &lt;h2&gt;我是默认插槽的内容--&#123;&#123; title &#125;&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;template #jack=&quot;&#123; title &#125;&quot;&gt;</span><br><span class="line">        &lt;h2&gt;&#123;&#123; title &#125;&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/nav-bar&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import NavBar from &#x27;./components/NavBar.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    NavBar,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 0;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>NavBar.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;slot :title=&quot;title&quot;&gt; &lt;/slot&gt;</span><br><span class="line">    &lt;slot name=&quot;jack&quot; :title=&quot;title&quot;&gt; &lt;/slot&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      title: &#x27;哈哈哈哈&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="4-非父子组件通信"><a href="#4-非父子组件通信" class="headerlink" title="4. 非父子组件通信"></a>4. 非父子组件通信</h2><p>在实际开发中父子组件之间的通信往往选择props和emits,除了父子之外我们还有一些其他的关系组件需要通信，比如爷孙，比如兄弟,甚至还有关系不太好描述的组件.</p>
<p>两种：全局事件总线bus,<strong>provide&#x2F;inject</strong></p>
<h3 id="4-1-全局事件总线"><a href="#4-1-全局事件总线" class="headerlink" title="4.1 全局事件总线"></a><strong>4.1 全局事件总线</strong></h3><p>在Vue2中是自带的，但是Vue3没有了移除了$on,$off,$once…方法，如果我们希望继续使用事件总线，要通过第三方的库。</p>
<p>mitt</p>
<ol>
<li><p>安装 npm install mitt -S</p>
</li>
<li><p>配置 在src&#x2F;utils&#x2F;bus.js中写入如下内容</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//事件总线</span></span><br><span class="line"><span class="keyword">import</span> mitt <span class="keyword">from</span> <span class="string">&#x27;mitt&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> bus = <span class="title function_">mitt</span>();</span><br><span class="line"><span class="comment">//暴露出去</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> bus;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>开始使用，就可以在任意关系的.vue文件之间传递数据</li>
</ol>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;school-com&gt;&lt;/school-com&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">//引入bus</span><br><span class="line">import bus from &#x27;@/utils/bus&#x27;;</span><br><span class="line">import SchoolCom from &#x27;./components/SchoolCom.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      list: [&#x27;alex&#x27;, &#x27;jesscia&#x27;],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  //组件被创建完毕</span><br><span class="line">  //监听eventbus事件但是不能发送</span><br><span class="line">  created() &#123;&#125;,</span><br><span class="line"></span><br><span class="line">  //虚拟DOM-&gt;真实DOM</span><br><span class="line">  //可以发送eventbus事件</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    bus.emit(&#x27;list&#x27;, this.list);</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    SchoolCom,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 0;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>StudentCom.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;student&quot;&gt;</span><br><span class="line">    &lt;h1&gt;1233122&lt;/h1&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li v-for=&quot;item in arr&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">        &#123;&#123; item &#125;&#125;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import bus from &#x27;@/utils/bus&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      arr: [],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  created() &#123;&#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    bus.on(&#x27;list&#x27;, (data) =&gt; &#123;</span><br><span class="line">      console.log(data);</span><br><span class="line">      this.arr = data;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.student &#123;</span><br><span class="line">  background-color: orange;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>虽然我们是爷爷和孙子通信但是这种bus的通信方式，任意关系的组件均可</p>
<p>发送数据 bus.emit(‘事件名称’,数据)</p>
<p>接收数据bus.on(‘事件名称’,(数据)&#x3D;&gt;{…})</p>
<p>接收所有的数据 bus.on(‘*’,(type,data)&#x3D;&gt;{type具体的某一个事件，data该事件的数据})</p>
<p>停止监听事件 bus.off(‘事件名称’)</p>
<h3 id="4-2-Provide和Inject"><a href="#4-2-Provide和Inject" class="headerlink" title="4.2 Provide和Inject"></a><strong>4.2 Provide和Inject</strong></h3><p>Provide和inject用于父辈组件向后代组件传递数据</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;button @click=&quot;editArr&quot;&gt;点我修改arr&lt;/button&gt;</span><br><span class="line">    &lt;app-father&gt;&lt;/app-father&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import AppFather from &#x27;./components/AppFather.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    editArr() &#123;</span><br><span class="line">      this.arr.push(4);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  //你要想用data中的数据this相关的，就得写成函数形式</span><br><span class="line">  provide() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      name: &#x27;alex&#x27;,</span><br><span class="line">      age: 18,</span><br><span class="line">      arr: this.arr,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  // //provide 提供给后代组件</span><br><span class="line">  // provide: &#123;</span><br><span class="line">  //   name: &#x27;alex&#x27;,</span><br><span class="line">  //   age: 18,</span><br><span class="line">  //   //this未定义 this指向谁？</span><br><span class="line">  //   //指向script根标签的this undefined</span><br><span class="line">  //   arr: this,</span><br><span class="line">  // &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      arr: [1, 2, 3],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    AppFather,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 0;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>AppSon.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h2&gt;&#123;&#123; name &#125;&#125;---&#123;&#123; age &#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;p&gt;&#123;&#123; arr &#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  //用inject来接收</span><br><span class="line">  inject: [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;arr&#x27;],</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    //undefined</span><br><span class="line">    console.log(this.arr);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>解决透传的时候响应式失效的问题,用vue3的computed</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;button @click=&quot;editArr&quot;&gt;点我修改arr&lt;/button&gt;</span><br><span class="line">    &lt;app-father&gt;&lt;/app-father&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">//用到vue3提供的函数来解决</span><br><span class="line">import &#123; computed &#125; from &#x27;vue&#x27;;</span><br><span class="line">import AppFather from &#x27;./components/AppFather.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    editArr() &#123;</span><br><span class="line">      this.arr.push(4);</span><br><span class="line">      console.log(this.arr);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  provide() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      name: &#x27;alex&#x27;,</span><br><span class="line">      age: 18,</span><br><span class="line">      //用computed解决响应式丢失</span><br><span class="line">      length: computed(() =&gt; this.arr.length),</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      arr: [1, 2, 3],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    AppFather,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 0;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>AppSon.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h2&gt;&#123;&#123; name &#125;&#125;---&#123;&#123; age &#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;p&gt;&#123;&#123; length &#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  //用inject来接收</span><br><span class="line">  inject: [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;length&#x27;],</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://muleandhorse.icu/2022/06/20/b41%20VUE%E7%BB%84%E4%BB%B6%E5%8C%96%E9%80%9A%E4%BF%A1(%E4%B8%80)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="RickyD">
      <meta itemprop="description" content="如果站长加班加似了，这个网站就是他留给世界最后的遗产">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mule and Horse">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/20/b41%20VUE%E7%BB%84%E4%BB%B6%E5%8C%96%E9%80%9A%E4%BF%A1(%E4%B8%80)/" class="post-title-link" itemprop="url">vue的组件化通信(一)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-20 16:06:09" itemprop="dateCreated datePublished" datetime="2022-06-20T16:06:09+08:00">2022-06-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-07-22 21:11:06" itemprop="dateModified" datetime="2023-07-22T21:11:06+08:00">2023-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>11 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="组件化通信"><a href="#组件化通信" class="headerlink" title="组件化通信"></a>组件化通信</h1><h2 id="1-Vue组件的嵌套关系"><a href="#1-Vue组件的嵌套关系" class="headerlink" title="1. Vue组件的嵌套关系"></a>1. Vue组件的嵌套关系</h2><h3 id="1-1-认识组件的嵌套"><a href="#1-1-认识组件的嵌套" class="headerlink" title="1.1 认识组件的嵌套"></a><strong>1.1 认识组件的嵌套</strong></h3><p>把如下结构拆分成组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;div class=&quot;header&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;top&quot;&gt;top bannerdiv&gt;</span><br><span class="line">      &lt;input type=&quot;text&quot; /&gt;</span><br><span class="line">      &lt;div class=&quot;nav&quot;&gt;div&gt;</span><br><span class="line">    div&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;div class=&quot;content&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;banner&quot;&gt;bannerdiv&gt;</span><br><span class="line">      &lt;ul&gt;</span><br><span class="line">        &lt;li&gt;商品列表1li&gt;</span><br><span class="line">        &lt;li&gt;商品列表2li&gt;</span><br><span class="line">        &lt;li&gt;商品列表3li&gt;</span><br><span class="line">        &lt;li&gt;商品列表4li&gt;</span><br><span class="line">      ul&gt;</span><br><span class="line">    div&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;div class=&quot;footer&quot;&gt;</span><br><span class="line">      &lt;div&gt;物流配送div&gt;</span><br><span class="line">      &lt;div&gt;版权声明div&gt;</span><br><span class="line">      &lt;div&gt;免责声明div&gt;</span><br><span class="line">      &lt;div&gt;注册地址：XXXXXdiv&gt;</span><br><span class="line">    div&gt;</span><br><span class="line">  div&gt;</span><br><span class="line">template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">&#125;;</span><br><span class="line">script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">div &#123;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">&#125;</span><br><span class="line">style&gt;</span><br></pre></td></tr></table></figure>





<p><img src="https://docimg5.docs.qq.com/image/AgAABlP525xQIwSredZF145EaC9T8V_i.png?w=442&h=233" alt="img"></p>
<p>拆分成如上结构以后，我们只需要去对应的组件，编写对应的逻辑即可。</p>
<h3 id="1-2-组件的通信"><a href="#1-2-组件的通信" class="headerlink" title="1.2 组件的通信"></a><strong>1.2 组件的通信</strong></h3><p>实际开发的时候，我们会经常遇到需要组件直接进行<strong>通信</strong>，即相互传递某些数据</p>
<p>在Vue中不管是面试还是实际开发，组件间的通信都非常的重要。</p>
<h2 id="2-父子组件通信"><a href="#2-父子组件通信" class="headerlink" title="2. 父子组件通信**"></a>2. 父子组件通信**</h2><h3 id="2-1-父子组件通信的方式"><a href="#2-1-父子组件通信的方式" class="headerlink" title="2.1 父子组件通信的方式"></a><strong>2.1 父子组件通信的方式</strong></h3><p>父组件传递给子组件：通过<strong>props</strong>属性</p>
<p>子组件传递给父组件：通过**$emit**触发事件</p>
<h3 id="2-2-父组件传递给子组件"><a href="#2-2-父组件传递给子组件" class="headerlink" title="2.2 父组件传递给子组件"></a><strong>2.2 父组件传递给子组件</strong></h3><p>props：props就是组件上自定义的attribute，父组件给这些attributes赋值，子组件通过对应的attribute的名称来使用。</p>
<p>props有两种常见的写法</p>
<ol>
<li><p>字符串数组:数组中的字符串就是attribute的名称</p>
</li>
<li><p>对象</p>
</li>
</ol>
<h4 id="2-2-1-props的数组用法"><a href="#2-2-1-props的数组用法" class="headerlink" title="2.2.1 props的数组用法"></a><strong>2.2.1 props的数组用法</strong></h4><p>ShowInfo.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;info&quot;&gt;</span><br><span class="line">    &lt;h2&gt;姓名:&#123;&#123; name &#125;&#125;h2&gt;</span><br><span class="line">    &lt;h2&gt;年龄:&#123;&#123; age &#125;&#125;h2&gt;</span><br><span class="line">    &lt;h2&gt;身高:&#123;&#123; height &#125;&#125;h2&gt;</span><br><span class="line">  div&gt;</span><br><span class="line">template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  //props 接收父组件传递过来的数据</span><br><span class="line">  props: [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;height&#x27;],</span><br><span class="line">&#125;;</span><br><span class="line">script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.info &#123;</span><br><span class="line">  background-color: skyblue;</span><br><span class="line">&#125;</span><br><span class="line">style&gt;</span><br></pre></td></tr></table></figure>

<p>App.vue</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;<span class="selector-tag">div</span> id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;!-- name前面不加：因为我们没有alex这个变量 --&gt;</span><br><span class="line">    &lt;show-info name=&quot;alex&quot; :age=<span class="string">&quot;18&quot;</span> :height=<span class="string">&quot;1.8&quot;</span>&gt;&lt;/show-info&gt;</span><br><span class="line">    &lt;show-info name=<span class="string">&quot;kern&quot;</span> :age=<span class="string">&quot;88&quot;</span> :height=<span class="string">&quot;1.6&quot;</span>&gt;&lt;/show-info&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import ShowInfo from <span class="string">&#x27;./components/ShowInfo.vue&#x27;</span>;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: <span class="string">&#x27;App&#x27;</span>,</span><br><span class="line">  components: &#123;</span><br><span class="line">    ShowInfo,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;xxxxxxxxxx &lt;template&gt;  &lt;<span class="selector-tag">div</span> id=&quot;app&quot;&gt;    &lt;!-- name前面不加：因为我们没有alex这个变量 --&gt;    &lt;show-info name=&quot;alex&quot; :age=<span class="string">&quot;18&quot;</span> :height=<span class="string">&quot;1.8&quot;</span>&gt;&lt;/show-info&gt;    &lt;show-info name=<span class="string">&quot;kern&quot;</span> :age=<span class="string">&quot;88&quot;</span> :height=<span class="string">&quot;1.6&quot;</span>&gt;&lt;/show-info&gt;  &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import ShowInfo from <span class="string">&#x27;./components/ShowInfo.vue&#x27;</span>;export default &#123;  name: <span class="string">&#x27;App&#x27;</span>,  components: &#123;    ShowInfo,  &#125;,&#125;;&lt;/script&gt;&lt;style lang=&quot;scss&quot; scoped&gt;* &#123;  <span class="attribute">margin</span>: <span class="number">10px</span>;&#125;&lt;/style&gt;* &#123;  <span class="attribute">margin</span>: <span class="number">10px</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>如果需要传递的数据非常多，而且这些数据有一定的共性，我们往往会选择全部放到一个对象里面来prop下去。</p>
<p>App.vue</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;<span class="selector-tag">div</span> id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;!-- name前面不加：因为我们没有alex这个变量 --&gt;</span><br><span class="line">    &lt;show-info :person=<span class="string">&quot;person&quot;</span>&gt;&lt;/show-info&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import ShowInfo from <span class="string">&#x27;./components/ShowInfo.vue&#x27;</span>;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: <span class="string">&#x27;App&#x27;</span>,</span><br><span class="line">  <span class="built_in">data</span>() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      person: &#123;</span><br><span class="line">        name: <span class="string">&#x27;alex&#x27;</span>,</span><br><span class="line">        age: <span class="number">18</span>,</span><br><span class="line">        height: <span class="number">1.8</span>,</span><br><span class="line">        hobby: <span class="string">&#x27;唱&#x27;</span>,</span><br><span class="line">        weight: <span class="string">&#x27;140斤&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    ShowInfo,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>ShowInfo.vue</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;<span class="selector-tag">div</span> id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;!-- name前面不加：因为我们没有alex这个变量 --&gt;</span><br><span class="line">    &lt;show-info :person=<span class="string">&quot;person&quot;</span>&gt;&lt;/show-info&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import ShowInfo from <span class="string">&#x27;./components/ShowInfo.vue&#x27;</span>;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: <span class="string">&#x27;App&#x27;</span>,</span><br><span class="line">  <span class="built_in">data</span>() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      person: &#123;</span><br><span class="line">        name: <span class="string">&#x27;alex&#x27;</span>,</span><br><span class="line">        age: <span class="number">18</span>,</span><br><span class="line">        height: <span class="number">1.8</span>,</span><br><span class="line">        hobby: <span class="string">&#x27;唱&#x27;</span>,</span><br><span class="line">        weight: <span class="string">&#x27;140斤&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    ShowInfo,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2-2-2-props对象写法"><a href="#2-2-2-props对象写法" class="headerlink" title="2.2.2 props对象写法"></a><strong>2.2.2 props对象写法</strong></h4><p>数组用法中我们只能传递attribute的名称，而且不能对其添加任意的限制，对象写法可以让我们的props更加的完善。</p>
<p>比如 限定传入的数据类型 type</p>
<p>比如 限定是否必传 required</p>
<p>比如 是否有默认值 default</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;!-- name前面不加：因为我们没有alex这个变量 --&gt;</span><br><span class="line">    &lt;show-info :person=&quot;person&quot;&gt;&lt;/show-info&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import ShowInfo from &#x27;./components/ShowInfo.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      person: &#123;</span><br><span class="line">        name: &#x27;alex&#x27;,</span><br><span class="line">        age: 18,</span><br><span class="line">        height: 1.8,</span><br><span class="line">        hobby: &#x27;唱&#x27;,</span><br><span class="line">        weight: &#x27;140斤&#x27;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    ShowInfo,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 10px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>ShowInfo.vue</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">&lt;templa&lt;template&gt;</span><br><span class="line">  &lt;<span class="selector-tag">div</span> id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;!-- name前面不加：因为我们没有alex这个变量 --&gt;</span><br><span class="line">    &lt;show-info :person=<span class="string">&quot;person&quot;</span>&gt;&lt;/show-info&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import ShowInfo from <span class="string">&#x27;./components/ShowInfo.vue&#x27;</span>;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: <span class="string">&#x27;App&#x27;</span>,</span><br><span class="line">  <span class="built_in">data</span>() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      person: &#123;</span><br><span class="line">        name: <span class="string">&#x27;alex&#x27;</span>,</span><br><span class="line">        age: <span class="number">18</span>,</span><br><span class="line">        height: <span class="number">1.8</span>,</span><br><span class="line">        hobby: <span class="string">&#x27;唱&#x27;</span>,</span><br><span class="line">        weight: <span class="string">&#x27;140斤&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    ShowInfo,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">te&gt;</span><br><span class="line">  &lt;<span class="selector-tag">div</span> class=&quot;info&quot;&gt;</span><br><span class="line">    &lt;<span class="selector-tag">h2</span>&gt;姓名:&#123;&#123; name &#125;&#125;&lt;/<span class="selector-tag">h2</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">h2</span>&gt;年龄:&#123;&#123; age &#125;&#125;&lt;/<span class="selector-tag">h2</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">h2</span>&gt;身高:&#123;&#123; <span class="attribute">height</span> &#125;&#125;&lt;/<span class="selector-tag">h2</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">p</span>&gt;</span><br><span class="line">      &#123;&#123; friend &#125;&#125;</span><br><span class="line">    &lt;/<span class="selector-tag">p</span>&gt;</span><br><span class="line">  &lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  //props的对象写法，更加完善</span><br><span class="line">  props: &#123;</span><br><span class="line">    name: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">    &#125;,</span><br><span class="line">    age: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      required: true,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attribute">height</span>: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      default: <span class="number">2</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    friend: &#123;</span><br><span class="line">      type: Object,</span><br><span class="line">      //这样写是不对的，对象类型的prop写default的时候必须使用函数</span><br><span class="line">      // default: &#123;</span><br><span class="line">      //   name: <span class="string">&#x27;jack&#x27;</span>,</span><br><span class="line">      // &#125;,</span><br><span class="line">      default: () =&gt; &#123;</span><br><span class="line">        return &#123; name: <span class="string">&#x27;jack&#x27;</span> &#125;;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line"><span class="selector-class">.info</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: skyblue;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>细节一：type类型都可以写那些</p>
<p><strong>String Number Boolean Array Object</strong> Date Function Symbol </p>
<p>细节二：传递对象类型的时候默认值,如果设置默认值必须写成函数。if组件存在多个实例，如果不使用函数的话，因为数组和对象都是引用类型，所以可能会导致在某一个实例中修改了数据，其他的实例都会被影响，他的本质原因和之前讲的data为什么必须是一个函数一样。</p>
<p>App.vue</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;<span class="selector-tag">div</span> id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;!-- name前面不加：因为我们没有alex这个变量 --&gt;</span><br><span class="line">    &lt;show-info :person=<span class="string">&quot;person&quot;</span>&gt;&lt;/show-info&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import ShowInfo from <span class="string">&#x27;./components/ShowInfo.vue&#x27;</span>;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: <span class="string">&#x27;App&#x27;</span>,</span><br><span class="line">  <span class="built_in">data</span>() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      person: &#123;</span><br><span class="line">        name: <span class="string">&#x27;alex&#x27;</span>,</span><br><span class="line">        age: <span class="number">18</span>,</span><br><span class="line">        height: <span class="number">1.8</span>,</span><br><span class="line">        hobby: <span class="string">&#x27;唱&#x27;</span>,</span><br><span class="line">        weight: <span class="string">&#x27;140斤&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    ShowInfo,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>ShowInfo.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;info&quot;&gt;</span><br><span class="line">    &lt;h2&gt;姓名:&#123;&#123; name &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;年龄:&#123;&#123; age &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;身高:&#123;&#123; height &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;p&gt;</span><br><span class="line">      &#123;&#123; friend &#125;&#125;</span><br><span class="line">    &lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  //props的对象写法，更加完善</span><br><span class="line">  props: &#123;</span><br><span class="line">    name: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">    &#125;,</span><br><span class="line">    age: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      required: true,</span><br><span class="line">    &#125;,</span><br><span class="line">    height: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      default: 2,</span><br><span class="line">    &#125;,</span><br><span class="line">    friend: &#123;</span><br><span class="line">      type: Object,</span><br><span class="line">      //这样写是不对的，对象类型的prop写default的时候必须使用函数</span><br><span class="line">      // default: &#123;</span><br><span class="line">      //   name: &#x27;jack&#x27;,</span><br><span class="line">      // &#125;,</span><br><span class="line">      default: () =&gt; &#123;</span><br><span class="line">        return &#123; name: &#x27;jack&#x27; &#125;;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.info &#123;</span><br><span class="line">  background-color: skyblue;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>细节三：prop的命名方式</p>
<p>在html中attribute名称<strong>大小写不敏感</strong>，浏览器会把所有的大写转成小写</p>
<p>当你在DOM的模版中使用小驼峰写prop的时候需要使用等价的短横线命名</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;show-info :show-msg=&quot;msg&quot;&gt;&lt;/show-info&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import ShowInfo from &#x27;./components/ShowInfo.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      msg: &#x27;123&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    ShowInfo,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 10px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ShowInfo.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;info&quot;&gt;</span><br><span class="line">    &lt;h1&gt;展示商品信息&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; showMsg &#125;&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: [&#x27;showMsg&#x27;],</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.info &#123;</span><br><span class="line">  background-color: skyblue;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>命名</p>
<p><strong>组件命名：注册的时候大驼峰，使用的时候短横线全小写</strong></p>
<p><strong>props: 传递的时候短横线(大小写不敏感),使用的时候小驼峰</strong></p>
<h4 id="2-2-3-非prop的attribute"><a href="#2-2-3-非prop的attribute" class="headerlink" title="2.2.3 非prop的attribute"></a><strong>2.2.3 非prop的attribute</strong></h4><p>定义：传递给组件的属性，没有在组件中使用对应的props定义，比如class,id,style</p>
<p>Attribute继承</p>
<p>​	当组件有单个根节点时，非prop的attribute会自动添加到组件的根节点的Attribute上</p>
<p><img src="https://img-1317399392.cos.ap-guangzhou.myqcloud.com/img/image-20230629192722486.png" alt="image-20230629192722486"></p>
<p>如果我们不希望组件继承这个attribute，可以在组件中设置 inheritAttrs:false。</p>
<p>ShowInfo.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;info&quot;&gt;</span><br><span class="line">    &lt;h1&gt;展示商品信息&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; showMsg &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;!-- 我们可以通过$attrs来访问所有的非prop的attributes --&gt;</span><br><span class="line">    &lt;p v-bind=&quot;$attrs&quot;&gt;我接受到所有的attr&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  //设置以后  最外层的div不会有active类名</span><br><span class="line">  inheritAttrs: false,</span><br><span class="line">  props: [&#x27;showMsg&#x27;],</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.info &#123;</span><br><span class="line">  background-color: skyblue;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;info&quot;&gt;</span><br><span class="line">    &lt;h1&gt;展示商品信息&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; showMsg &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;!-- 我们可以通过$attrs来访问所有的非prop的attributes --&gt;</span><br><span class="line">    &lt;p v-bind=&quot;$attrs&quot;&gt;我接受到所有的attr&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  //设置以后  最外层的div不会有active类名</span><br><span class="line">  inheritAttrs: false,</span><br><span class="line">  props: [&#x27;showMsg&#x27;],</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.info &#123;</span><br><span class="line">  background-color: skyblue;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>多个根节点attribute</p>
<p>​	会警告，我们必须手动绑定对应的属性</p>
<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;info&quot;&gt;</span><br><span class="line">    &lt;h1&gt;展示商品信息&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; showMsg &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;!-- 我们可以通过$attrs来访问所有的非prop的attributes --&gt;</span><br><span class="line">    &lt;p v-bind=&quot;$attrs&quot;&gt;我接受到所有的attr&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  //设置以后  最外层的div不会有active类名</span><br><span class="line">  inheritAttrs: false,</span><br><span class="line">  props: [&#x27;showMsg&#x27;],</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.info &#123;</span><br><span class="line">  background-color: skyblue;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>ShowInfo.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;info&quot;&gt;</span><br><span class="line">    &lt;h1&gt;展示商品信息&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; showMsg &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;!-- 我们可以通过$attrs来访问所有的非prop的attributes --&gt;</span><br><span class="line">    &lt;p v-bind=&quot;$attrs&quot;&gt;我接受到所有的attr&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  //设置以后  最外层的div不会有active类名</span><br><span class="line">  inheritAttrs: false,</span><br><span class="line">  props: [&#x27;showMsg&#x27;],</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.info &#123;</span><br><span class="line">  background-color: skyblue;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="2-3-子组件传递给父组件"><a href="#2-3-子组件传递给父组件" class="headerlink" title="2.3 子组件传递给父组件"></a><strong>2.3 子组件传递给父组件</strong></h3><ol>
<li><p>在子组件中定义好触发事件的名称</p>
</li>
<li><p>在父组件中以v-on的形式监听第一步的事件名，并且写好对应的回调</p>
</li>
<li><p>在子组件中触发事件的时候，父组件根据监听的回调进行对应的处理</p>
</li>
</ol>
<h4 id="2-3-1-基本使用"><a href="#2-3-1-基本使用" class="headerlink" title="2.3.1 基本使用"></a><strong>2.3.1 基本使用</strong></h4><p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;h2&gt;当前计数&#123;&#123; counter &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;!-- 2.v-on监听add事件 --&gt;</span><br><span class="line">    &lt;add-counter @add=&quot;addBtn&quot;&gt;&lt;/add-counter&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import AddCounter from &#x27;./components/AddCounter.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      counter: 0,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    addBtn() &#123;</span><br><span class="line">      //3.当子组件中的按钮被点击这个函数会执行</span><br><span class="line">      this.counter++;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    AddCounter,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 10px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>AddCounter.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;button @click=&quot;btnClick&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    btnClick() &#123;</span><br><span class="line">      //1.定义好事件的名称通过$emit</span><br><span class="line">      //定义好一个add事件给父组件监听</span><br><span class="line">      this.$emit(&#x27;add&#x27;);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h4 id="2-3-2-emit传参"><a href="#2-3-2-emit传参" class="headerlink" title="2.3.2 emit传参"></a><strong>2.3.2 emit传参</strong></h4><p>AddCounter.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;button @click=&quot;btnClick(1)&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;btnClick(5)&quot;&gt;+5&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;btnClick(100)&quot;&gt;+100&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  //为了开发者工具考虑在option中声明emit</span><br><span class="line">  //1.数组语法</span><br><span class="line">  // emits: [&#x27;add&#x27;],</span><br><span class="line">  //2. 对象语法</span><br><span class="line">  //添加校验</span><br><span class="line">  emits: &#123;</span><br><span class="line">    //如果校验失败会弹出警告</span><br><span class="line">    add: function (count) &#123;</span><br><span class="line">      if (count &lt;= 5) &#123;</span><br><span class="line">        return true;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        console.log(123, &#x27;校验失败&#x27;);</span><br><span class="line">        return false;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    btnClick(num) &#123;</span><br><span class="line">      //1. 定义事件</span><br><span class="line">      //第一个参数自定义事件的名称</span><br><span class="line">      //第二个参数是你要传递的参数</span><br><span class="line">      this.$emit(&#x27;add&#x27;, num);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;h2&gt;当前计数&#123;&#123; counter &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;!-- 2.v-on监听add事件 --&gt;</span><br><span class="line">    &lt;add-counter @add=&quot;addBtn&quot;&gt;&lt;/add-counter&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import AddCounter from &#x27;./components/AddCounter.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      counter: 0,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    //接收参数</span><br><span class="line">    addBtn(count) &#123;</span><br><span class="line">      //count接收参数</span><br><span class="line">      //3.当子组件中的按钮被点击这个函数会执行</span><br><span class="line">      this.counter += count;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    AddCounter,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 10px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>自己写一下减法的，创建一个SubCounter.vue</p>
<h2 id="3-练习"><a href="#3-练习" class="headerlink" title="3. 练习"></a>3. 练习</h2><h3 id="3-1-tab切换"><a href="#3-1-tab切换" class="headerlink" title="3.1 tab切换"></a><strong>3.1 tab切换</strong></h3><p><img src="https://img-1317399392.cos.ap-guangzhou.myqcloud.com/img/image-20230629193012805.png" alt="image-20230629193012805"></p>
<p>TabControl.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;tab-control&quot;&gt;</span><br><span class="line">    &lt;div</span><br><span class="line">      v-for=&quot;(item, index) in titles&quot;</span><br><span class="line">      :key=&quot;&#123; item &#125;&quot;</span><br><span class="line">      class=&quot;item&quot;</span><br><span class="line">      :class=&quot;&#123; active: index === currentIndex &#125;&quot;</span><br><span class="line">      @click=&quot;itemClick(index)&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &#123;&#123; item &#125;&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      currentIndex: 0,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  //props接收</span><br><span class="line">  props: [&#x27;titles&#x27;],</span><br><span class="line">  methods: &#123;</span><br><span class="line">    itemClick(index) &#123;</span><br><span class="line">      // console.log(123);</span><br><span class="line">      this.currentIndex = index;</span><br><span class="line">      this.$emit(&#x27;itemChange&#x27;, index);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.tab-control &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  height: 40px;</span><br><span class="line">  line-height: 40px;</span><br><span class="line">  text-align: center;</span><br><span class="line">  .item &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">  &#125;</span><br><span class="line">  .item.active &#123;</span><br><span class="line">    color: orange;</span><br><span class="line">    font-weight: 700;</span><br><span class="line">    border-bottom: 1px solid orange;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>app.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;tab-control</span><br><span class="line">      :titles=&quot;[&#x27;phone&#x27;, &#x27;pc&#x27;, &#x27;others&#x27;]&quot;</span><br><span class="line">      @itemChange=&quot;itemChange&quot;</span><br><span class="line">    &gt;&lt;/tab-control&gt;</span><br><span class="line">    &lt;div&gt;&#123;&#123; pageContents[index] &#125;&#125;&lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import TabControl from &#x27;./components/TabControl.vue&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      pageContents: [</span><br><span class="line">        &#x27;手机页面这里有很多99包邮的手机&#x27;,</span><br><span class="line">        &#x27;电脑:imac大折扣0元购&#x27;,</span><br><span class="line">        &#x27;周边:双飞燕键鼠套装1.9包邮&#x27;,</span><br><span class="line">      ],</span><br><span class="line">      index: 0,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    itemChange(index) &#123;</span><br><span class="line">      // console.log(index);</span><br><span class="line">      this.index = index;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    TabControl,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 10px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="3-2-购物车🛒"><a href="#3-2-购物车🛒" class="headerlink" title="3.2 购物车🛒"></a><strong>3.2 购物车🛒</strong></h3><p>data.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">list</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">id</span>: <span class="number">625153951363</span>,</span><br><span class="line">      <span class="comment">//商品数量</span></span><br><span class="line">      <span class="attr">number</span>: <span class="number">15</span>,</span><br><span class="line">      <span class="comment">//已购数量</span></span><br><span class="line">      <span class="attr">buy_num</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">select</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;2020西太湖国际音乐节&#x27;</span>,</span><br><span class="line">      <span class="attr">showTime</span>: <span class="string">&#x27;2020.09.19-09.20&#x27;</span>,</span><br><span class="line">      <span class="attr">price</span>: <span class="string">&#x27;100&#x27;</span>,</span><br><span class="line">      <span class="attr">city</span>: <span class="string">&#x27;常州&#x27;</span>,</span><br><span class="line">      <span class="attr">address</span>: <span class="string">&#x27;常州西太湖中国花卉博览景区北门&#x27;</span>,</span><br><span class="line">      <span class="attr">pic</span>: <span class="string">&#x27;https://img.alicdn.com/bao/uploaded/https://img.alicdn.com/imgextra/i3/2251059038/O1CN01zJEpaN2GdSG1Xvo8y_!!2251059038.jpg&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">id</span>: <span class="number">624506842658</span>,</span><br><span class="line">      <span class="attr">number</span>: <span class="number">10</span>,</span><br><span class="line">      <span class="attr">buy_num</span>: <span class="number">3</span>,</span><br><span class="line">      <span class="attr">select</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;2020舟山东海音乐节&#x27;</span>,</span><br><span class="line">      <span class="attr">showTime</span>: <span class="string">&#x27;2020.09.04-09.06&#x27;</span>,</span><br><span class="line">      <span class="attr">price</span>: <span class="string">&#x27;200&#x27;</span>,</span><br><span class="line">      <span class="attr">city</span>: <span class="string">&#x27;舟山&#x27;</span>,</span><br><span class="line">      <span class="attr">address</span>: <span class="string">&#x27;舟山市朱家尖南沙景区沙滩&#x27;</span>,</span><br><span class="line">      <span class="attr">pic</span>: <span class="string">&#x27;https://img.alicdn.com/bao/uploaded/i4/2251059038/O1CN01L70FVl2GdSG2wpwyE_!!0-item_pic.jpg&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">id</span>: <span class="number">623216520608</span>,</span><br><span class="line">      <span class="attr">number</span>: <span class="number">8</span>,</span><br><span class="line">      <span class="attr">buy_num</span>: <span class="number">2</span>,</span><br><span class="line">      <span class="attr">select</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;中国•磐安 2020氧气山水音乐节&#x27;</span>,</span><br><span class="line">      <span class="attr">showTime</span>: <span class="string">&#x27;2020.08.22 周六 16:30&#x27;</span>,</span><br><span class="line">      <span class="attr">price</span>: <span class="string">&#x27;300&#x27;</span>,</span><br><span class="line">      <span class="attr">city</span>: <span class="string">&#x27;金华&#x27;</span>,</span><br><span class="line">      <span class="attr">address</span>: <span class="string">&#x27;金华磐安花溪风景区&#x27;</span>,</span><br><span class="line">      <span class="attr">pic</span>: <span class="string">&#x27;https://img.alicdn.com/bao/uploaded/https://img.alicdn.com/imgextra/i3/2251059038/O1CN01ECp69h2GdSFpoUPAm_!!2251059038.jpg&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">id</span>: <span class="number">624345993344</span>,</span><br><span class="line">      <span class="attr">number</span>: <span class="number">13</span>,</span><br><span class="line">      <span class="attr">buy_num</span>: <span class="number">2</span>,</span><br><span class="line">      <span class="attr">select</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;2020“一生中最爱”七夕演唱会&#x27;</span>,</span><br><span class="line">      <span class="attr">showTime</span>: <span class="string">&#x27;2020.08.25 周二 19:30&#x27;</span>,</span><br><span class="line">      <span class="attr">price</span>: <span class="string">&#x27;400&#x27;</span>,</span><br><span class="line">      <span class="attr">city</span>: <span class="string">&#x27;北京&#x27;</span>,</span><br><span class="line">      <span class="attr">address</span>: <span class="string">&#x27;糖果TANGO-雍和宫店三层&#x27;</span>,</span><br><span class="line">      <span class="attr">pic</span>: <span class="string">&#x27;https://img.alicdn.com/bao/uploaded/i3/2251059038/O1CN01WGNYBE2GdSFqXJgII_!!0-item_pic.jpg&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">id</span>: <span class="number">624170605605</span>,</span><br><span class="line">      <span class="attr">number</span>: <span class="number">5</span>,</span><br><span class="line">      <span class="attr">buy_num</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">select</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;东海五渔节之敢潮音乐节&#x27;</span>,</span><br><span class="line">      <span class="attr">showTime</span>: <span class="string">&#x27;2020.08.22 周六 18:00&#x27;</span>,</span><br><span class="line">      <span class="attr">price</span>: <span class="string">&#x27;500&#x27;</span>,</span><br><span class="line">      <span class="attr">city</span>: <span class="string">&#x27;舟山&#x27;</span>,</span><br><span class="line">      <span class="attr">address</span>: <span class="string">&#x27;舟山嵊泗五龙乡听海广场(原黄沙村船厂)&#x27;</span>,</span><br><span class="line">      <span class="attr">pic</span>: <span class="string">&#x27;https://img.alicdn.com/bao/uploaded/https://img.alicdn.com/imgextra/i1/2251059038/O1CN01eV5pR32GdSFxJUb0v_!!2251059038.jpg&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>





<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;content&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;top&quot;&gt;&lt;input type=&quot;checkbox&quot; /&gt; 全选&lt;/div&gt;</span><br><span class="line">      &lt;ul class=&quot;center&quot;&gt;</span><br><span class="line">        &lt;li&gt;</span><br><span class="line">          &lt;div class=&quot;select&quot;&gt;</span><br><span class="line">            &lt;input type=&quot;checkbox&quot; /&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;pic&quot;&gt;</span><br><span class="line">            &lt;img src=&quot;&quot; alt=&quot;&quot; /&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;name&quot;&gt;asdhgfasghdfg&lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;price&quot;&gt;￥ &lt;span&gt;100.00&lt;/span&gt;&lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;number&quot;&gt;</span><br><span class="line">            &lt;button&gt;-&lt;/button&gt;</span><br><span class="line">            &lt;input type=&quot;text&quot; value=&quot;1&quot; /&gt;</span><br><span class="line">            &lt;button&gt;+&lt;/button&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;subtotal&quot;&gt;￥ &lt;span&gt;100.00&lt;/span&gt;&lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;del&quot;&gt;</span><br><span class="line">            &lt;button&gt;删除&lt;/button&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line">      &lt;div class=&quot;bottom&quot;&gt;</span><br><span class="line">        &lt;p&gt;总购买数量: 3&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">          &lt;button class=&quot;pay&quot;&gt;去结算&lt;/button&gt;</span><br><span class="line">          &lt;button class=&quot;clear&quot;&gt;清空购物车&lt;/button&gt;</span><br><span class="line">          &lt;button class=&quot;clear_select&quot;&gt;删除所有已选中&lt;/button&gt;</span><br><span class="line">          &lt;button class=&quot;list&quot;&gt;返回列表页&lt;/button&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;p&gt;总价格 : ￥ &lt;span&gt;100.00&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import mock from &#x27;./data&#x27;;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      list: mock.list,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;&#125;,</span><br><span class="line">  components: &#123;&#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">* &#123;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 0;</span><br><span class="line">  list-style: none;</span><br><span class="line">  text-decoration: none;</span><br><span class="line">&#125;</span><br><span class="line">button,</span><br><span class="line">input &#123;</span><br><span class="line">  outline: none;</span><br><span class="line">  border: none;</span><br><span class="line">&#125;</span><br><span class="line">img &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">  display: block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content &#123;</span><br><span class="line">  width: 1200px;</span><br><span class="line">  padding: 10px 0;</span><br><span class="line">  margin: 0 auto;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">&#125;</span><br><span class="line">.content .top,</span><br><span class="line">.content .bottom &#123;</span><br><span class="line">  height: 40px;</span><br><span class="line">  display: flex;</span><br><span class="line">  align-items: center;</span><br><span class="line">  background-color: pink;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content .top &gt; input &#123;</span><br><span class="line">  width: 20px;</span><br><span class="line">  height: 20px;</span><br><span class="line">  margin: 0 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content .bottom &#123;</span><br><span class="line">  justify-content: space-around;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content .bottom &gt; p button &#123;</span><br><span class="line">  font-size: 20px;</span><br><span class="line">  padding: 3px 10px;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">  color: #fff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content .bottom &gt; p &gt; button.pay &#123;</span><br><span class="line">  background-color: green;</span><br><span class="line">&#125;</span><br><span class="line">.content .bottom &gt; p &gt; button.clear &#123;</span><br><span class="line">  background-color: red;</span><br><span class="line">&#125;</span><br><span class="line">.content .bottom &gt; p &gt; button.clear_select &#123;</span><br><span class="line">  background-color: orange;</span><br><span class="line">&#125;</span><br><span class="line">.content .bottom &gt; p &gt; button.list &#123;</span><br><span class="line">  background-color: skyblue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content .bottom &gt; p &gt; span &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content .center &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">&#125;</span><br><span class="line">.content .center &gt; li &#123;</span><br><span class="line">  height: 100px;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  align-items: center;</span><br><span class="line">  border: 1px solid #333;</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">  margin: 10px 0;</span><br><span class="line">  border-radius: 10px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content .center &gt; li &gt; div &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  align-items: center;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content .center &gt; li &gt; div &gt; span &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content .center &gt; li &gt; div:first-child &gt; input &#123;</span><br><span class="line">  width: 20px;</span><br><span class="line">  height: 20px;</span><br><span class="line">&#125;</span><br><span class="line">.content .center &gt; li &gt; div &gt; button &#123;</span><br><span class="line">  font-size: 20px;</span><br><span class="line">  padding: 5px 10px;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">&#125;</span><br><span class="line">.content .center &gt; li &gt; div &gt; .del &gt; button &#123;</span><br><span class="line">  background-color: red;</span><br><span class="line">  color: #fff;</span><br><span class="line">&#125;</span><br><span class="line">.content .center &gt; li &gt; div.number &gt; input &#123;</span><br><span class="line">  width: 50px;</span><br><span class="line">  height: 24px;</span><br><span class="line">  font-size: 20px;</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line">.select,</span><br><span class="line">.pic,</span><br><span class="line">.del &#123;</span><br><span class="line">  width: 100px;</span><br><span class="line">&#125;</span><br><span class="line">.name,</span><br><span class="line">.price,</span><br><span class="line">.subtotal &#123;</span><br><span class="line">  width: 200px;</span><br><span class="line">&#125;</span><br><span class="line">.number &#123;</span><br><span class="line">  width: 300px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://muleandhorse.icu/2022/06/18/b40%20VUE%E7%BB%84%E4%BB%B6%E5%8C%96%E5%BC%80%E5%8F%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="RickyD">
      <meta itemprop="description" content="如果站长加班加似了，这个网站就是他留给世界最后的遗产">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mule and Horse">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/18/b40%20VUE%E7%BB%84%E4%BB%B6%E5%8C%96%E5%BC%80%E5%8F%91/" class="post-title-link" itemprop="url">vue的组件化开发思想</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-18 16:06:09" itemprop="dateCreated datePublished" datetime="2022-06-18T16:06:09+08:00">2022-06-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-07-22 21:05:35" itemprop="dateModified" datetime="2023-07-22T21:05:35+08:00">2023-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="组件化开发"><a href="#组件化开发" class="headerlink" title="组件化开发"></a><strong>组件化开发</strong></h1><h2 id="1-组件化开发的思想"><a href="#1-组件化开发的思想" class="headerlink" title="1.组件化开发的思想**"></a>1.组件化开发的思想**</h2><h3 id="1-1-认识组件化开发"><a href="#1-1-认识组件化开发" class="headerlink" title="1.1 认识组件化开发"></a><strong>1.1 认识组件化开发</strong></h3><p>组件化开发也是类似的把大问题转成很多个方便解决的小问题，比如如果将所有的逻辑全部放在一起，处理起来变得非常复杂，而且不利于后续的维护和扩展。但是如果我们把页面拆成一个个小的功能块，每个功能块完成自己独立的部分，整个页面的管理就变得非常容易。</p>
<p>学习组件化开发最重要的是他的思想，每个框架，平台具体的实现不同，但是思想都是一样的。</p>
<p>组件最大的好处是方便<strong>复用</strong>。</p>
<h3 id="1-2-Vue的组件化开发"><a href="#1-2-Vue的组件化开发" class="headerlink" title="1.2 Vue的组件化开发"></a><strong>1.2 Vue的组件化开发</strong></h3><p>组件化是Vue的核心思想，也是课程的重点内容</p>
<p>​	前面我们的createApp函数传入了一个配置对象App，这个对象本质上就是一个组件，而且也是整个应用程序的根(Root)组件</p>
<p>组件化开发，简单来说就是两步</p>
<ol>
<li><p>注册组件</p>
</li>
<li><p>使用组件</p>
</li>
</ol>
<h3 id="1-3-Vue的SFC"><a href="#1-3-Vue的SFC" class="headerlink" title="1.3 Vue的SFC"></a><strong>1.3 Vue的SFC</strong></h3><p>真实开发中，我们会通过一个后缀名为.vue的单文件组件(Single File Component)来解决，并且通过统一的开发结构；vue-cli&#x2F;vite&#x2F;webpack&#x2F;rollup。</p>
<p>使用sfc的.vue文件来开发</p>
<ol>
<li><p>使用VueCLi来创建项目</p>
</li>
<li><p>自己用webpack或者vite来处理</p>
</li>
</ol>
<h2 id="2-VueCLI"><a href="#2-VueCLI" class="headerlink" title="2. VueCLI"></a>2. VueCLI</h2><h3 id="2-1-什么是VueCLI脚手架？"><a href="#2-1-什么是VueCLI脚手架？" class="headerlink" title="2.1 什么是VueCLI脚手架？"></a><strong>2.1 什么是VueCLI脚手架？</strong></h3><p>真实开发我们不可能每一个项目都从头来配置webpack&#x2F;vite，这样开发效率会非常的低，所以真实开发我们通常会使用脚手架(帮助我们搭建好一些基础结构)来创建项目，Vue项目所使用的就是Vue的脚手架即Vue CLI</p>
<p>​	CLI：Command Line Interface 命令行界面</p>
<p>​	vue-cli已经内置了webpack的配置，不需要从0开始</p>
<h3 id="2-2-Vue-CLI的安装和使用"><a href="#2-2-Vue-CLI的安装和使用" class="headerlink" title="2.2 Vue CLI的安装和使用"></a><strong>2.2 Vue CLI的安装和使用</strong></h3><p>安装：npm install @vue&#x2F;cli -g</p>
<p>升级: npm update @vue&#x2F;cli -g</p>
<p>使用：vue create 项目名</p>
<p>更多： <a target="_blank" rel="noopener" href="https://cli.vuejs.org/zh/">https://cli.vuejs.org/zh/</a></p>
<p>Windows用户，vue-cli的配置文件在一个叫做**.vuerc**的文件上,<strong>C:\Users{当前用户名}</strong></p>
<p><img src="https://img-1317399392.cos.ap-guangzhou.myqcloud.com/img/image-20230629175510917.png" alt="image-20230629175510917"></p>
<p><strong>browserslist文件：做浏览器适配</strong></p>
<p><img src="https://img-1317399392.cos.ap-guangzhou.myqcloud.com/img/image-20230629175543524.png" alt="image-20230629175543524"></p>
<p><strong>jsconfig.json: 给vscode用的</strong></p>
<p><strong>额外补充：tree</strong></p>
<p>windows可以直接使用：</p>
<p>mac需要安装tree，<strong>homebrew install tree</strong></p>
<p>如果报错得先安装homebrew</p>
<p>命令：tree &gt; tree.md 这样你的整个项目目录会被输出到当前的tree.md文件中</p>
<p>忽略node_modules文件夹的目录输出：tree -I ‘node_modules’ &gt; tree.md</p>
<p>其他命令自行百度命令行tree的使用</p>
<h2 id="3-组件的注册方式"><a href="#3-组件的注册方式" class="headerlink" title="3. 组件的注册方式**"></a>3. 组件的注册方式**</h2><p>如果我有一部分内容(模版，逻辑)，我们希望把这部分内容抽到一个独立的组件中维护，那我们就得先注册</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;h2&gt;&#123;&#123;title&#125;&#125;&lt;/h2&gt;</span><br><span class="line">&lt;p&gt;&#123;&#123;msg&#125;&#125;&lt;/p&gt;</span><br></pre></td></tr></table></figure>

<p><strong>全局组件</strong>：在其他任何组件中都能使用</p>
<p><strong>局部组件</strong>：只有在注册了的组件中才能使用</p>
<h3 id="3-1-全局注册组件"><a href="#3-1-全局注册组件" class="headerlink" title="3.1 全局注册组件"></a><strong>3.1 全局注册组件</strong></h3><p>全局注册组件需要我们使用全局创建的app来注册</p>
<p>通过app的component方法传入组件的名称，组件的实现</p>
<p>之后就可以使用了。</p>
<ol>
<li>创建组件</li>
</ol>
<p>在components文件夹中创建一个my-cpn.vue的文件，写入内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; title &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; msg &#125;&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">//1.创建组件</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      title: &#x27;我是组件的标题&#x27;,</span><br><span class="line">      msg: &#x27;我是组件的内容&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">div &#123;</span><br><span class="line">  background-color: orange;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>注册组件</li>
</ol>
<p>修改main.js的内容</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span>;</span><br><span class="line"><span class="comment">//2.注册组件</span></span><br><span class="line"><span class="comment">//2.1 引入组件</span></span><br><span class="line"><span class="keyword">import</span> myCpn <span class="keyword">from</span> <span class="string">&#x27;./components/my-cpn.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>);</span><br><span class="line"><span class="comment">//写自己对app需要的配置选项操作</span></span><br><span class="line"><span class="comment">//2.2注册全局组件</span></span><br><span class="line"><span class="comment">//第一个参数是将来使用的时候要用的名字</span></span><br><span class="line"><span class="comment">//第二个参数是具体组件的实现</span></span><br><span class="line">app.<span class="title function_">component</span>(<span class="string">&#x27;my-cpn&#x27;</span>, myCpn);</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>使用组件</li>
</ol>
<p>在App.vue中使用对应的组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;!-- 3.使用组件 --&gt;</span><br><span class="line">    &lt;my-cpn&gt;&lt;/my-cpn&gt;</span><br><span class="line">    &lt;my-cpn&gt;&lt;/my-cpn&gt;</span><br><span class="line">    &lt;my-cpn&gt;&lt;/my-cpn&gt;</span><br><span class="line">    &lt;my-cpn&gt;&lt;/my-cpn&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-2-组件自己的逻辑"><a href="#3-2-组件自己的逻辑" class="headerlink" title="3.2 组件自己的逻辑"></a><strong>3.2 组件自己的逻辑</strong></h3><p>组件也可以有自己的代码逻辑，比如自己的data，methods，computed…</p>
<p>再创建一个组件product-item</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;product&quot;&gt;</span><br><span class="line">    &lt;h2&gt;&#123;&#123; title &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; msg &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;button @click=&quot;demo&quot;&gt;点我&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      title: &#x27;我是product的title&#x27;,</span><br><span class="line">      msg: &#x27;我是product的msg&#x27;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    demo() &#123;</span><br><span class="line">      console.log(123);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">.product &#123;</span><br><span class="line">  background-color: skyblue;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="https://img-1317399392.cos.ap-guangzhou.myqcloud.com/img/image-20230629190448429.png" alt="image-20230629190448429"></p>
<p><img src="https://img-1317399392.cos.ap-guangzhou.myqcloud.com/img/image-20230629190513276.png" alt="image-20230629190513276"></p>
<p>scoped样式隔离：如果style标签不加scoped隔离，会导致样式穿透，那个组件后引入就应用对应的样式，哪怕之前有同样的选择器，自己的样式也不生效。加一个scoped就能解决，为什么？</p>
<p>原理：<img src="https://img-1317399392.cos.ap-guangzhou.myqcloud.com/img/image-20230629190540916.png" alt="image-20230629190540916"> 加了scoped以后每个组件的内的模版中的所有标签都加上了一个 **data-v-[hash:8]**，最终你的style样式应用上去的时候会自动加上一个对应的属性选择器div[data-v-hash]{}</p>
<p>为什么data必须是一个函数：让每个组件都有自己的独立的数据。</p>
<h3 id="3-3-组件的命名"><a href="#3-3-组件的命名" class="headerlink" title="3.3 组件的命名"></a><strong>3.3 组件的命名</strong></h3><p>在我们注册全局组件是通过app.component（），参数一是组件的名字，参数二是组件的实现</p>
<p>命名的方式有两种</p>
<ol>
<li>kebab-case短横线命名 <strong>my-cpn</strong></li>
</ol>
<p>​	使用的时候只能短横线 <code>&lt;my-cpn&gt; &lt;/my-cpn&gt;</code></p>
<ol start="2">
<li>PascalCase大驼峰 <strong>MyCpn</strong></li>
</ol>
<p>​	使用的时候短横线和大驼峰均可 </p>
<p>我们修改main.js测试一下</p>
<p>main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span>;</span><br><span class="line"><span class="comment">//2.注册组件</span></span><br><span class="line"><span class="comment">//2.1 引入组件</span></span><br><span class="line"><span class="keyword">import</span> myCpn <span class="keyword">from</span> <span class="string">&#x27;./components/my-cpn.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> productItem <span class="keyword">from</span> <span class="string">&#x27;./components/product-item.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>);</span><br><span class="line"><span class="comment">//写自己对app需要的配置选项操作</span></span><br><span class="line"><span class="comment">//2.2注册全局组件</span></span><br><span class="line"><span class="comment">//第一个参数是将来使用的时候要用的名字</span></span><br><span class="line"><span class="comment">//第二个参数是具体组件的实现</span></span><br><span class="line">app.<span class="title function_">component</span>(<span class="string">&#x27;MyCpn&#x27;</span>, myCpn);</span><br><span class="line">app.<span class="title function_">component</span>(<span class="string">&#x27;product-item&#x27;</span>, productItem);</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;!-- 3.使用组件 --&gt;</span><br><span class="line">    &lt;my-cpn&gt;&lt;/my-cpn&gt;</span><br><span class="line">    &lt;!-- 大驼峰注册的时候 也可以大驼峰来使用 --&gt;</span><br><span class="line">    &lt;MyCpn&gt;&lt;/MyCpn&gt;</span><br><span class="line">    &lt;product-item&gt;&lt;/product-item&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-4-局部组件"><a href="#3-4-局部组件" class="headerlink" title="3.4 局部组件"></a><strong>3.4 局部组件</strong></h3><p>全局组件往往会在应用程序一开始就注册，这样有些组件即使没有使用到，也会注册</p>
<ol>
<li><p>打包后的js体积会增加，不利于webpack的tree shaking</p>
</li>
<li><p>使得依赖关系的维护很困难，而且不太容易定位子组件的实现，以及过多的全局变量</p>
</li>
</ol>
<p>所以开发中除非明确是全局都需要的一般都会采用局部组件的形式</p>
<p>使用局部组件操作如下</p>
<ol>
<li><p>编写并且注册，通过选项API，<strong>components</strong>选项来注册</p>
</li>
<li><p>components中的选项对应的是一个对象，对象中<strong>key:组件的名称</strong>，<strong>value：组件的实现</strong></p>
</li>
</ol>
<p>恢复main.js的内容，我们尝试在App.vue中注册为局部组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;MyList&gt;&lt;/MyList&gt;</span><br><span class="line">    &lt;!-- 3.使用组件 --&gt;</span><br><span class="line">    &lt;my-cpn&gt;&lt;/my-cpn&gt;</span><br><span class="line">    &lt;!-- 大驼峰注册的时候 也可以大驼峰来使用 --&gt;</span><br><span class="line">    &lt;MyCpn&gt;&lt;/MyCpn&gt;</span><br><span class="line">    &lt;product-item&gt;&lt;/product-item&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">//引入组件</span><br><span class="line">import MyCpn from &#x27;./components/my-cpn.vue&#x27;;</span><br><span class="line">import productItem from &#x27;./components/product-item.vue&#x27;;</span><br><span class="line">import MyList from &#x27;./components/my-list.vue&#x27;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">  //配置App用的组件</span><br><span class="line">  components: &#123;</span><br><span class="line">    //注册</span><br><span class="line">    // &#x27;MyCpn&#x27;: MyCpn,</span><br><span class="line">    //简写</span><br><span class="line">    MyCpn,</span><br><span class="line">    &#x27;product-item&#x27;: productItem,</span><br><span class="line">    MyList,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注册为局部组件以后，我们的组件就只能在App内使用，其他地方用不了。</p>
<h2 id="4-组件化通信"><a href="#4-组件化通信" class="headerlink" title="4. 组件化通信**"></a>4. 组件化通信**</h2><p>拆分组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;!-- 头部 --&gt;</span><br><span class="line">    &lt;div class=&quot;header&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;top&quot;&gt;top banner&lt;/div&gt;</span><br><span class="line">      &lt;input type=&quot;text&quot; /&gt;</span><br><span class="line">      &lt;div class=&quot;nav&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 中间主体 --&gt;</span><br><span class="line">    &lt;div class=&quot;content&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;banner&quot;&gt;banner&lt;/div&gt;</span><br><span class="line">      &lt;ul&gt;</span><br><span class="line">        &lt;li&gt;商品列表1&lt;/li&gt;</span><br><span class="line">        &lt;li&gt;商品列表2&lt;/li&gt;</span><br><span class="line">        &lt;li&gt;商品列表3&lt;/li&gt;</span><br><span class="line">        &lt;li&gt;商品列表4&lt;/li&gt;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 底部footer --&gt;</span><br><span class="line">    &lt;div class=&quot;footer&quot;&gt;</span><br><span class="line">      &lt;div&gt;物流配送&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;版权声明&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;免责声明&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;注册地址：XXXXX&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="RickyD"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">RickyD</p>
  <div class="site-description" itemprop="description">如果站长加班加似了，这个网站就是他留给世界最后的遗产</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">67</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/RickyDriver" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;RickyDriver" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/1552330861@qq.com" title="E-Mail → 1552330861@qq.com"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2020 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RickyD</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">135k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">7:30</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body>
</html>
